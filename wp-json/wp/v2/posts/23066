{"id":23066,"date":"2018-01-21T14:06:03","date_gmt":"2018-01-21T22:06:03","guid":{"rendered":"https:\/\/coertvonk.com\/?p=23066"},"modified":"2022-04-30T17:56:23","modified_gmt":"2022-05-01T00:56:23","slug":"talk-to-your-cd-player","status":"publish","type":"post","link":"http:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066","title":{"rendered":"Talk to your old CD player"},"content":{"rendered":"<p>\n    Have you ever wondered why you should buy new devices just because the old ones don&#8217;t support IoT?   Any device controlled by an infrared remote can be transferred into an IoT device with a Adafruit ESP8266, an infrared receiver and LED, and your remote control. With the help of an IR code library, I was able to make a program that does just that.<\/p>\n<div class=\"align-center\">\n<figure>\n<div class=\"flex-container tight\">\n                <a class=\"hide-anchor fancybox\" data-fancybox=\"svg\" data-width=\"249\" data-height=\"143\" href=\"\/wp-content\/uploads\/dialog-4.svg\"><br \/>\n                    <img  title=\"\" loading=\"lazy\" src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/dialog-4.svg\" alt=\"Dialog with Google Home\" width=\"249\" height=\"144\"  \/><br \/>\n                <\/a>\n            <\/div>\n<\/figure><\/div>\n<\/p>\n<p>\n    Triggered with the phrase &#8220;Hey Google&#8221;, the Google Assistant is able to feed the words following the trigger phrase into its database of applets, one of which is IFTTT. Once one of the applets recognizes the phrase, it responds with a statement showing that it has acknowledged the command. In this case the answer phrase is set by the user. The Google Assistant will respond by saying the term set in IFTTT. I set it to &#8220;IR Code Sent.&#8221; The conversation will be something like the one shown in the conversation above.\n<\/p>\n<h2>\n    Problem analysis<br \/>\n<\/h2>\n<p>\n    Our goal is to teach the Google Assistant to control a device with an IR signal. In this case we use a Panasonic SC-HC20 CD player.\n<\/p>\n<p>\n    We need a device, controlled by Google Assistant that can mimic an infrared remote control. In this project we will try to build that device and hook it up to Google Assistant using IFTTT (If This Then That). We build this so people do not have to buy new devices just so they can be controlled by &#8220;smart&#8221; devices.\n<\/p>\n<h2>\n    Design considerations<br \/>\n<\/h2>\n<div class=\"align-center\">\n<figure>\n<div class=\"flex-container tight\">\n                <a class=\"hide-anchor fancybox\" href=\"\/wp-content\/uploads\/Choices.svg\"><img src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/Choices.svg\" alt=\"Considerations\" width=\"170\" \/><\/a>\n            <\/div>\n<\/figure><\/div>\n<\/p>\n<p>\n    We will give an overview of what we found and explain some of the trade-offs that we made.\n<\/p>\n<h3>\n    Teaching Google Assistant skills<br \/>\n<\/h3>\n<div class=\"align-center\">\n<figure>\n<div class=\"flex-container tight\">\n                <a class=\"hide-anchor fancybox\" href=\"\/wp-content\/uploads\/google-home-in-classroom-sml-1.jpg\"><br \/>\n                    <img src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/google-home-in-classroom-sml-1.jpg\" alt=\"Google Home in classroom learning new tricks\" width=\"400\" \/><br \/>\n                <\/a>\n            <\/div>\n<\/figure><\/div>\n<\/p>\n<p>\n    Adding Skills to the Google Assistant can be challenging, but IFTTT simplifies the process by setting up the api.ai (Google&#8217;s Voice Recognition Platform) part of the equation. This was normally the tricky part of teaching the Google Assistant, and IFTTT makes this much simpler. Now all we need to do is configure IFTTT and code the transmitting device.<\/p>\n<ul>\n<li>\n            <a href=\"https:\/\/ifttt.com\/google_assistant\">If This Then That<\/a> (IFTTT) adds custom voice commands to Google Assistant and can sent information to a device using HTTP\n        <\/li>\n<li>\n            <a href=\"https:\/\/developers.google.com\/assistant\">Actions on Google<\/a> adds a dialog to Google Assistant and supports sending and reading information to\/from devices.\n        <\/li>\n<\/ul>\n<h3>\n    Infrared Interface platform<br \/>\n<\/h3>\n<div class=\"align-center\">\n<figure>\n<div class=\"flex-container tight\">\n                <a class=\"hide-anchor fancybox\" href=\"\/wp-content\/uploads\/IoT-modules-small.png\"><br \/>\n                    <img src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/IoT-modules-small.png\" alt=\"Various IoT boards\" width=\"400\" \/><br \/>\n                <\/a>\n            <\/div>\n<\/figure><\/div>\n<\/p>\n<p>\n    We need to make a device that can accept commands over WiFi and relay them as infrared commands to the CD player. <\/p>\n<ul>\n<li>Requirements: small, low power, WiFi, GPIO (general purpose i\/o pins)<\/li>\n<li>Contestants:  Arduino, ESP8266, Arduino 101, ESP32<\/li>\n<li>Winner: Adafruit Feather Huzzah ESP8266.  1 MByte flash enough for over the air updates. Micro USB for code upload \/ debugging.Y<\/li>\n<\/ul>\n<h3>\n    Infrared Interface infrared codes<br \/>\n<\/h3>\n<div class=\"align-center\">\n<figure>\n<div class=\"flex-container tight\">\n                <a class=\"hide-anchor fancybox\" href=\"\/wp-content\/uploads\/CD-player-remote.svg\"><br \/>\n                    <img src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/CD-player-remote.svg\" alt=\"Infrared beam\" width=\"200\" \/><br \/>\n                <\/a>\n            <\/div>\n<\/figure><\/div>\n<\/p>\n<p>\n    Our device needs to be able to mimic the remote as to control the CD player.\n<\/p>\n<ul>\n<li>\n            Requirements: must support the platform; it ideally should recognize the device codes so we don&#8217;t have to use raw IR timings.\n        <\/li>\n<li>\n            Contestants: A fork from Chris Young\u2019s IRlib;\n        <\/li>\n<li>\n            Winner:A fork from Chris Young\u2019s IRlib;\n        <\/li>\n<\/ul>\n<h3 id=\"design-router\">\n    Traversing the WiFi router<br \/>\n<\/h3>\n<p>\n    The access router in our home is a jack-of-all-trades. Among its many duties it protects the home network from outside intruders. This comes with a catch: Google Assistant needs access to our home network to control the CD player. This means we need to provide a mechanism in which Google Assistant can contact the CD device.\n<\/p>\n<p>\n    Like with anything else on the internet, there are many choices to consider. The two trains of thought are:<\/p>\n<ul>\n<li>\n            Make an <i>exception in the firewall<\/i> to accept and forward incoming commands to the IR interface. We can also use this router to handle the more resource intense encryption and scrutinize the commands to prevent code injection. Problem is that anything on the internet can access our webserver, so we need an authentication mechanism. There are two protocols that come to mind: HTTP and MQTT. HTTP is the protocol that brings the web pages that you visit to you. We can use it to push messages from Google Assistant to our IR interface. The other protocol, <em>MQTT<\/em>, is designed to provide low latency, assured messaging over fragile networks and efficient distribution to one or many receivers. It is less known but powers Facebook, and is supported by AWS IoT.\n        <\/li>\n<li>\n            <i>Maintain a connection<\/i> to a web service, so that it can send messages to the IR interface over that existing connection.  When using the HTTP protocol, we need a kludges like long polling or websocket. A more elegant solution is <em>Firebase Cloud messaging<\/em>, but that requires a substantial amount of memory to handle HTTPS and identifiers. It <a href=\"https:\/\/github.com\/esp8266\/Arduino\/issues\/3125\">appears<\/a> to run on ESP8266. The memory is used for HTTPS, UID and authToken.  Problem is that it causes a lot of idle traffic and requires an intermediate server (because IFTTT doesn&#8217;t support it directly).\n        <\/li>\n<\/ul>\n<p>\n    IoT devices are characterized by a small processor, little memory and low power usage.  In this respect MQTT would be ideal. However, this requires a bridge such as <a href=\"https:\/\/www.eclipse.org\/projects\/archives.php\">Ponte<\/a> or web service to translate between HTTP and MQTT. Instead, we decided to go with the more common HTTPS protocol.\n<\/p>\n<h2>\n    Design, development and unit testing<br \/>\n<\/h2>\n<div class=\"align-center\">\n<figure>\n<div class=\"flex-container tight\">\n                <a class=\"hide-anchor fancybox\" href=\"\/wp-content\/uploads\/circle-data-flow.svg\"><br \/>\n                    <img src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/circle-data-flow.svg\" alt=\"Data flow for Infrared Interface\" width=\"500\" \/><br \/>\n                <\/a>\n            <\/div><figcaption>\n                Data flow for Infrared Interface<br \/>\n            <\/figcaption><\/figure>\n<\/p><\/div>\n<\/p>\n<p>\n    The design consists of various blocks as illustrated below. We will describe the design, development and the unit testing for these blocks.  We will start the Infrared Interface and work our way up to integrating it with the Google Assistant ecosystem.\n<\/p>\n<p>\n    All code is available through the repository:<\/p>\n<div class=\"flex-container tight\">\n         <a class=\"hide-anchor\" href=\"https:\/\/github.com\/sandervonk\/esp8266-infrared\">             <img src=\"https:\/\/socialify.git.ci\/sandervonk\/esp8266-infrared\/image?description=1&#038;issues=1&#038;language=1&#038;name=1&#038;owner=1&#038;pattern=Circuit%20Board&#038;stargazers=1&#038;theme=Light\" width=\"500\" \/>         <\/a>\n    <\/div>\n<\/p>\n<h3>\n    Infrared Interface<br \/>\n<\/h3>\n<p>\n    We go straight to the exciting part: the infrared interface.<\/p>\n<div class=\"align-center\">\n<figure>\n<div class=\"flex-container tight\">\n                <a class=\"hide-anchor fancybox\" href=\"\/wp-content\/uploads\/Data-flow-ESP8266-3.svg\"><br \/>\n                    <img src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/Data-flow-ESP8266-3.svg\" alt=\"Data flow for Infrared Interface\" width=\"500\" \/><br \/>\n                <\/a>\n            <\/div><figcaption>\n                Data flow for Infrared Interface<br \/>\n            <\/figcaption><\/figure>\n<\/p><\/div>\n<\/p>\n<h4>\n    Design<br \/>\n<\/h4>\n<p>\n    The hardware for this project is straightforward. The microcontroller is an ESP8266-based Feather HUZZAH that already has an USB interface for programming and debugging.\n<\/p>\n<p>\n    The software uses a framework that provides: online WiFi SSID\/passwd configuration, saves fatal exception details to non-volatile memory and supports over-the-air (OTA) software updates.\n<\/p>\n<h4>\n    Development<br \/>\n<\/h4>\n<p>\n    The ESP8266 is connected to an Infrared Receiver to decoding signals from the original remote control of the CD player. To send infrared codes to the CD player it uses a transistor to drive an IR LED.\n<\/p>\n<h5>\n    Hardware<br \/>\n<\/h5>\n<div class=\"align-center\">\n<figure>\n<div class=\"flex-container tight\">\n                <a class=\"hide-anchor fancybox\" href=\"\/wp-content\/uploads\/IR-Interface-small-2.svg\"><br \/>\n                    <img src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/IR-Interface-small-2.svg\" alt=\"Schematic of WiFi\/IR interface\" width=\"600\" \/><br \/>\n                <\/a>\n            <\/div><figcaption>\n                WiFi\/IR interface schematic<br \/>\n            <\/figcaption><\/figure>\n<\/p><\/div>\n<\/p>\n<p>\n    Build the circuit as shown in the schematic above.<\/p>\n<ol>\n<li>\n            <cspan class=\"hilight\">Gather<\/cspan> the parts shown in the table below.  Be careful to use the PN2222A or 2N222A transistor (not the P2N2222A).<\/p>\n<table class=\"cvonk-table small grey-background\">\n<tr>\n<th>Label<\/th>\n<th>Part#<\/th>\n<th>Description<\/th>\n<th>Information<\/th>\n<th>We paid<\/th>\n<\/tr>\n<tr>\n<td>IR1<\/td>\n<td>Vishay TSOP38238<\/td>\n<td>Infrared Receiver 38kHz<\/td>\n<td><a href=\"https:\/\/www.mouser.com\/datasheet\/2\/427\/tsop382-531411.pdf\">datasheet<\/a><\/td>\n<td>$ 1.08<\/td>\n<\/tr>\n<tr>\n<td>D1<\/td>\n<td>Everlight EL-SIR333-A<\/td>\n<td>Infrared Diode 875nm 1.5V<sub>drop<\/sub><\/td>\n<td>datasheet<\/td>\n<td>$ 0.39<\/td>\n<\/tr>\n<tr>\n<td>T1<\/td>\n<td>PN2222Atfr<\/td>\n<td>NPN Transistor<\/td>\n<td><a href=\"https:\/\/www.mouser.com\/datasheet\/2\/308\/PN2222A-1121407.pdf\">datasheet<\/a><\/td>\n<td>$ 0.49<\/td>\n<\/tr>\n<tr>\n<td>PCB1<\/td>\n<td>Feather HUZZAH ESP8266<\/td>\n<td>Microcontroller board<\/td>\n<td><a href=\"https:\/\/learn.adafruit.com\/adafruit-feather-huzzah-esp8266\/downloads\">detail<\/a><\/td>\n<td>$ 16.95<\/td>\n<\/tr>\n<tr>\n<td>R1<\/td>\n<td>1k&#x2126; &frac14;W<\/td>\n<td>Resistor<\/td>\n<td><\/td>\n<td>$ 0.02<\/td>\n<\/tr>\n<tr>\n<td>R2<\/td>\n<td>68&#x2126; &frac14;W<\/td>\n<td>Resistor<\/td>\n<td><\/td>\n<td>$ 0.02<\/td>\n<\/tr>\n<tr>\n<td><\/td>\n<td>Feather Proto board<\/td>\n<td><\/td>\n<td><a href=\"https:\/\/www.adafruit.com\/product\/2884\">detail<\/a><\/td>\n<td>$ 4.95<\/td>\n<\/tr>\n<\/table>\n<\/li>\n<li>\n            <cspan class=\"hilight\">Assemble<\/cspan> the circuit using a breadboard or prototyping board. The illustration below shows the pinouts.<\/p>\n<div class=\"align-center\">\n<figure>\n<div class=\"flex-container tight\">\n                        <a class=\"hide-anchor fancybox\" href=\"\/wp-content\/uploads\/ir-interface-pinout-6.svg\"><br \/>\n                            <img src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/ir-interface-pinout-6.svg\" alt=\"Semiconductor pinouts ir-interface\" width=\"300\" \/><br \/>\n                        <\/a>\n                    <\/div><figcaption>\n                        Semiconductor pinouts<br \/>\n                    <\/figcaption><\/figure>\n<\/p><\/div>\n<\/li>\n<li>\n            <cspan class=\"hilight\">Test <code>T1<\/code> and <code>D1<\/code><\/cspan>. Disconnect <code>R1<\/code> from the ESP8266 module, and connect it to the 3.3V rail to verify that the voltage drop over <code>R1<\/code> is approximately 3.4 V, indicating that the current through the infrared diode is 3.4V\/68&#x2126;=50mA. Reconnect the resistor to the ESP8266. Alternatively you can use camcorder to view the infrared light.\n        <\/li>\n<li>\n            Note that we used the 5 Volt rails (labeled <code>USB<\/code> to supply the Infrared LED with sufficient current.\n        <\/li>\n<\/ol>\n<div class=\"align-center\">\n<figure>\n<div class=\"flex-container tight\">\n                <a class=\"hide-anchor fancybox\" href=\"\/wp-content\/uploads\/protoboard-b-small.jpg\"><br \/>\n                    <img src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/protoboard-b-small.jpg\" alt=\"We assemble it for prosperity on a prototyping board\" width=\"400\" \/><br \/>\n                <\/a>\n            <\/div><figcaption>\n                We assemble it for prosperity on a prototyping board<br \/>\n            <\/figcaption><\/figure>\n<\/p><\/div>\n<\/p>\n<h5>\n    Software<br \/>\n<\/h5>\n<p>\n    When IFTTT makes the web request via Webhooks, the host of the website, in this case an Adafruit Huzzah Feather ESP8266 receives the command, and checks the command against its list of valid commands. If the command checks out, then it is matched to the corresponding IR command. It then sends the value out to the CD player, which completes the action.<\/p>\n<ol>\n<li>\n            <cspan class=\"hilight\">Prepare<\/cspan> your Arduino IDE or Microsoft Visual Studio environment. Install the board support and libraries listed in the table below.<\/p>\n<table class=\"cvonk-table small grey-background\">\n<caption>IDE, board support and external libraries<\/caption>\n<tr>\n<th>Type<\/th>\n<th>Component<\/th>\n<th>Author<\/th>\n<th>Version tested<\/th>\n<\/tr>\n<tr>\n<td>IDE<\/td>\n<td><a href=\"https:\/\/www.arduino.cc\/\">Arduino<\/a><\/td>\n<td>arduino.cc and community<\/td>\n<td>1.8.5<\/td>\n<\/tr>\n<tr>\n<td>Board support<\/td>\n<td><a href=\"https:\/\/learn.adafruit.com\/adafruit-feather-huzzah-esp8266\/using-arduino-ide\">ESP8266<\/a><\/td>\n<td>esp8266 community<\/td>\n<td>2.4.0<\/td>\n<\/tr>\n<tr>\n<td>Library<\/td>\n<td><a href=\"https:\/\/github.com\/tzapu\/WiFiManager\">WiFiManager<\/a><\/td>\n<td>tzapu<\/td>\n<td>0.12.0<\/td>\n<\/tr>\n<tr>\n<td>Library<\/td>\n<td>ESP8266 Framework<\/td>\n<td>Coert Vonk<\/td>\n<td>1.0.0<\/td>\n<\/tr>\n<tr>\n<td>Library<\/td>\n<td><a href=\"https:\/\/github.com\/cvonk\/esp8266-fatal\">ESP8266 Fatal<\/a><\/td>\n<td>Coert Vonk, forked from Krzysztof<\/td>\n<td>1.0.0<\/td>\n<\/tr>\n<tr>\n<td>Library<\/td>\n<td><a href=\"https:\/\/github.com\/crankyoldgit\/IRremoteESP8266\">IRremoteESP8266<\/a><\/td>\n<td>Sebastien Warin et al.<\/td>\n<td>2.3.1<\/td>\n<\/tr>\n<\/table>\n<\/li>\n<li>\n            <cspan class=\"hilight\">Training<\/cspan> is required so that the device issues the correct infrared codes to the CD player. to capture the infrared codes from the existing remote control, we used the example <code>IRrecvDumpV2<\/code> from the <code>IRremoteESP8266<\/code> library. <\/p>\n<ol>\n<li>Compile and upload it to the device over USB Serial, then open the Serial Monitor.<\/li>\n<li>Press the relevant buttons and note the button pressed and codes generated. E.g. for my CD player it shows the the manufacture&#8217;s address as <code>0x4004<\/code> (Panasonic) and the code for &#8220;play&#8221; as <code>0x05505005<\/code>.<\/li>\n<\/ol>\n<\/li>\n<li>\n            <cspan class=\"hilight\">Program<\/cspan> the device using the code from GitHub.<\/p>\n<ol>\n<li>Copy or clone <a href=\"https:\/\/github.com\/sandervonk\/esp8266-infrared\/blob\/master\/ir-interface\/ir-interface.ino\"><code>ir-interface.c<\/code><\/a>.<\/li>\n<li>Update the code with your own codes.<\/li>\n<li>Compile and upload it to the device over USB Serial.  Subsequent uploads may be performed using over-the-air (OTA) updates.<\/li>\n<li>The first time the board starts up it will be in Access Point mode. Use a computer or phone to connect to WiFi network.  If it doesn&#8217;t automatically connect you to the device, use a browser with any address. Use the browser to configure your networks SSID and password.  These values will be saved in EEPROM so next time the device can connect directly.<\/li>\n<li>Open a serial monitor and note the IP address assigned to the device.<\/li>\n<\/ol>\n<\/li>\n<\/ol>\n<h4>\n    Unit testing<br \/>\n<\/h4>\n<ol>\n<li>\n            Test the <cspan class=\"hilight\">webserver<\/cspan> pointing a webbrowser at <code>http:\/\/ir-interface.local\/ir\/ir<\/code>.  You should see the infrared menu.\n        <\/li>\n<li>\n            Test a <cspan class=\"hilight\">keyword<\/cspan> by pointing a webbrowser at e.g. <code>http:\/\/ir-interface.local\/ir?req=play<\/code>.  The CD player should start playing.  The image below shows the pulse train on an oscilloscope<\/p>\n<div class=\"align-center\">\n<figure>\n<div class=\"flex-container tight\">\n                        <a class=\"hide-anchor fancybox\" href=\"\/wp-content\/uploads\/infrared-pulsetrain.svg\"><br \/>\n                            <img src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/infrared-pulsetrain.svg\" alt=\"Infrared pulse train\" width=\"250\" \/><br \/>\n                        <\/a>\n                    <\/div><figcaption>\n                        Infrared pulse train<br \/>\n                    <\/figcaption><\/figure>\n<\/p><\/div>\n<\/li>\n<li>\n            Test the remaining keywords\n        <\/li>\n<\/ol>\n<h3>\n    Access router<br \/>\n<\/h3>\n<p>\n    The <a href=\"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#design-router\">design<\/a> relies on the router as an integral part of the solution.  It functions as a remote proxy and translates between HTTPS used on the internet and HTTP on the local area network.\n<\/p>\n<h4>\n    Design<br \/>\n<\/h4>\n<div class=\"align-center\">\n<figure>\n<div class=\"flex-container tight\">\n                <a class=\"hide-anchor fancybox\" href=\"\/wp-content\/uploads\/reverse-proxy-protocol-ir-2.svg\"><br \/>\n                    <img src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/reverse-proxy-protocol-ir-2.svg\" alt=\"Reverse proxy messages\" width=\"550\" \/><br \/>\n                <\/a>\n            <\/div><figcaption>\n                Reverse proxy messages<br \/>\n            <\/figcaption><\/figure>\n<\/p><\/div>\n<\/p>\n<h4>\n    Development<br \/>\n<\/h4>\n<p>\n    Install a reverse-proxy and TLS-certificates on your WiFi router.  Detailed instructions for routers with DD-WRT firmware can be found at <a href=\"\/sw\/networking\/dd-wrt-reverse-proxy-https-asus-rt-ac68-pound-letsencrypt-23660\">DD-WRT Reverse Proxy and HTTPS<\/a>.  Alternatively, you can configure <i>port forwarding<\/i> on your WiFi router.  In that case you need to use <code>http<\/code> instead of <code>https<\/code>.\n<\/p>\n<h4>\n    Unit testing<br \/>\n<\/h4>\n<p>\n    Drumroll please &#8230;<\/p>\n<ol>\n<li>Use a webbrowser to access <code>https:\/\/ir.home.domain.com\/ir<\/code>.  It should respond with a list of valid commands.<\/li>\n<li>Use a webbrowser to issue <code>https:\/\/ir.home.domain.com\/ir?req=play<\/code>.  It should respond with &#8220;Sending play&#8221;.<\/li>\n<li>Continue with testing the other keywords.<\/li>\n<\/ol>\n<h3>\n    If This Then That<br \/>\n<\/h3>\n<p>\n    If This Then That, commonly referred to as IFTTT, is a web service that preforms actions through multiple services when a applet is triggered, you can customize both the trigger and the action using <a href=\"htps:\/\/www.ifttt.com\/create\">their interface<\/a>. In this project we use the Google Assistant as the trigger and Webhooks to preform the web request.\n<\/p>\n<h4>\n    Design<br \/>\n<\/h4>\n<div class=\"align-center\">\n<figure>\n<div class=\"flex-container tight\">\n                <a class=\"hide-anchor fancybox\" href=\"\/wp-content\/uploads\/data-flow-IFTTT-2.svg\"><br \/>\n                    <img src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/data-flow-IFTTT-2.svg\" alt=\"Data flow from Google Home to If This Then That\" width=\"650\" \/><br \/>\n                <\/a>\n            <\/div><figcaption>\n                Data flow from Google Home to If This Then That<br \/>\n            <\/figcaption><\/figure>\n<\/p><\/div>\n<\/p>\n<h4>\n    Development<br \/>\n<\/h4>\n<p>\n    The tricky part is setting up IFTTT. To do this go to the IFTTT site; click on <span class=\"hp41-key\">Continue with Google<\/span> and create a new applet (Profile Dropdown &raquo; New Applet)<\/p>\n<ol style=\"list-style:upper-alpha\">\n<li>\n            Start by specifying a <cspan class=\"hilight\">trigger<\/cspan> by clicking the <span class=\"hp41-cikey\">+this<\/span> and selecting &#8220;Google Assistant&#8221; from the list of services. <\/p>\n<ol>\n<li>\n                    Click <span class=\"hp41-key\">Connect<\/span> to authorize IFTTT to manage voice commands\n                <\/li>\n<li>\n                    Click <span class=\"hp41-key\">Say a phrase with a text ingredient<\/span>, and fill in the trigger fields:<\/p>\n<ul>\n<li>What do you want to say? = <code>CD $<\/code><\/li>\n<li>What&#8217;s another way to say it? = <code>remote $<\/code>\n<li>What do you want the Assistant to say in response? = <code>Sending IR Code<\/code><\/li>\n<li>Press <span class=\"hp41-key\">Create Trigger<\/span><\/li>\n<\/ul>\n<\/li>\n<\/ol>\n<\/li>\n<li>\n            Specify the <cspan class=\"hilight\">Action<\/cspan> by clicking the <span class=\"hp41-cikey\">+that<\/span>.<\/p>\n<ol start=\"3\">\n<li>\n                    Choose action service = Select &#8220;Webhooks&#8221; and press <span class=\"hp41-key\">Connect<\/span>\n                <\/li>\n<li>\n                    Choose action = Make a web request\n                <\/li>\n<li>\n                    Fill in the action fields<\/p>\n<ul>\n<li>URL = <code>https:\/\/ir.home.domain.com\/ir?req={{TextField}}<\/code><\/li>\n<li>Method = <code>GET<\/code><\/li>\n<li>Content Type = <code>text\/plain<\/code><\/li>\n<li>Press <span class=\"hp41-key\">Create Action<\/span><\/li>\n<\/ul>\n<\/li>\n<li>\n                    Press <span class=\"hp41-key\">Finish<\/span>\n                <\/li>\n<\/ol>\n<\/li>\n<\/ol>\n<h2>\n    Testing<br \/>\n<\/h2>\n<p>\n    Now for the fun part:<\/p>\n<ol>\n<li>\n            <cspan class=\"hilight\">Prepare<\/cspan><\/p>\n<ul>\n<li>While still on the IFTTT site at the <i>My Applets > Google Assistant<\/i>, click <span class=\"hp41-key\">Check now<\/span>.<\/li>\n<li>Connect to the serial port of the ESP8266 using the Serial Monitor on the Arduino IDE<\/li>\n<\/ul>\n<\/li>\n<li>\n            <cspan class=\"hilight\">Give it a shot<\/cspan><\/p>\n<ul>\n<li>Use a Google Home (or on another Assistant enabled device), and say &#8220;Hey Google CD Play&#8221;.<\/li>\n<li>The Google Home should reply with &#8220;Sending IR Code&#8221;.<\/li>\n<li>On the Serial Monitor, you should see &#8220;Sending Play&#8221;.<\/li>\n<li>The CD player should start.<\/li>\n<li>Give yourself a pat on the back and continue with testing the other keywords.<\/li>\n<\/ul>\n<\/li>\n<\/ol>\n<div class=\"continue-container no-print\">\n<div class=\"continue-content\">\n<div class=\"continue-text\">\n                I hope this device will help you modernize your home without spending hundreds on replacement devices. To further modernize your home you can build your own smart alarm clock that syncs alarms and events from Google Calendar<br \/>\nESP8266 reads Google Calendar\n            <\/div>\n<\/p><\/div>\n<\/p><\/div><\/p>\n","protected":false},"excerpt":{"rendered":"<p>Describes how to use a microcontroller and infrared LED, to let Google Assistant control infrared enabled devices.<\/p>\n","protected":false},"author":4,"featured_media":23712,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"inline_featured_image":false,"_mi_skip_tracking":false},"categories":[441],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v18.6 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Talk to your old CD Player - Sander Vonk<\/title>\n<meta name=\"description\" content=\"Describes how to use a microcontroller and infrared LED, to let Google Assistant control devices. Talk to your CD player using Google Home.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Talk to your old CD Player - Sander Vonk\" \/>\n<meta property=\"og:description\" content=\"Describes how to use a microcontroller and infrared LED, to let Google Assistant control devices. Talk to your CD player using Google Home.\" \/>\n<meta property=\"og:url\" content=\"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066\" \/>\n<meta property=\"og:site_name\" content=\"Coert Vonk\" \/>\n<meta property=\"article:published_time\" content=\"2018-01-21T22:06:03+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2022-05-01T00:56:23+00:00\" \/>\n<meta name=\"twitter:card\" content=\"summary\" \/>\n<meta name=\"twitter:image\" content=\"https:\/\/coertvonk.com\/wp-content\/uploads\/IR-device-icon-5.svg\" \/>\n<meta name=\"twitter:label1\" content=\"Written by\" \/>\n\t<meta name=\"twitter:data1\" content=\"Sander\" \/>\n\t<meta name=\"twitter:label2\" content=\"Est. reading time\" \/>\n\t<meta name=\"twitter:data2\" content=\"10 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":[\"Person\",\"Organization\"],\"@id\":\"https:\/\/coertvonk.com\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e\",\"name\":\"Coert Vonk\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/coertvonk.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"http:\/\/1.gravatar.com\/avatar\/193315b96c6661985694e2ecd91f2996?s=96&d=mm&r=g\",\"contentUrl\":\"http:\/\/1.gravatar.com\/avatar\/193315b96c6661985694e2ecd91f2996?s=96&d=mm&r=g\",\"caption\":\"Coert Vonk\"},\"logo\":{\"@id\":\"https:\/\/coertvonk.com\/#personlogo\"},\"description\":\"Passionately curious and stubbornly persistent. Enjoys to inspire and consult with others to exchange the poetry of logical ideas.\",\"sameAs\":[\"https:\/\/coertvonk.com\"]},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/coertvonk.com\/#website\",\"url\":\"https:\/\/coertvonk.com\/\",\"name\":\"Coert Vonk\",\"description\":\"Embedded Software Engineer\",\"publisher\":{\"@id\":\"https:\/\/coertvonk.com\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/coertvonk.com\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#primaryimage\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/coertvonk.com\/wp-content\/uploads\/IR-device-icon-5.svg\",\"contentUrl\":\"https:\/\/coertvonk.com\/wp-content\/uploads\/IR-device-icon-5.svg\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#webpage\",\"url\":\"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066\",\"name\":\"Talk to your old CD Player - Sander Vonk\",\"isPartOf\":{\"@id\":\"https:\/\/coertvonk.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#primaryimage\"},\"datePublished\":\"2018-01-21T22:06:03+00:00\",\"dateModified\":\"2022-05-01T00:56:23+00:00\",\"description\":\"Describes how to use a microcontroller and infrared LED, to let Google Assistant control devices. Talk to your CD player using Google Home.\",\"breadcrumb\":{\"@id\":\"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Vonk Family\",\"item\":\"https:\/\/coertvonk.com\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Software\",\"item\":\"https:\/\/coertvonk.com\/category\/sw\"},{\"@type\":\"ListItem\",\"position\":3,\"name\":\"Arduino\",\"item\":\"https:\/\/coertvonk.com\/category\/sw\/arduino\"},{\"@type\":\"ListItem\",\"position\":4,\"name\":\"Talk to your old CD player\"}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#article\",\"isPartOf\":{\"@id\":\"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#webpage\"},\"author\":{\"@id\":\"https:\/\/coertvonk.com\/#\/schema\/person\/521ea61187d3b92aa6edc27efb066099\"},\"headline\":\"Talk to your old CD player\",\"datePublished\":\"2018-01-21T22:06:03+00:00\",\"dateModified\":\"2022-05-01T00:56:23+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#webpage\"},\"wordCount\":2010,\"commentCount\":0,\"publisher\":{\"@id\":\"https:\/\/coertvonk.com\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e\"},\"image\":{\"@id\":\"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#primaryimage\"},\"thumbnailUrl\":\"https:\/\/coertvonk.com\/wp-content\/uploads\/IR-device-icon-5.svg\",\"articleSection\":[\"Arduino\"],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https:\/\/coertvonk.com\/#\/schema\/person\/521ea61187d3b92aa6edc27efb066099\",\"name\":\"Sander\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/coertvonk.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"http:\/\/2.gravatar.com\/avatar\/50d5e0c60134564102be740dadcda2ce?s=96&d=mm&r=g\",\"contentUrl\":\"http:\/\/2.gravatar.com\/avatar\/50d5e0c60134564102be740dadcda2ce?s=96&d=mm&r=g\",\"caption\":\"Sander\"},\"description\":\"Student at MVHS.\",\"url\":\"http:\/\/coertvonk.com\/author\/sander-vonk\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"Talk to your old CD Player - Sander Vonk","description":"Describes how to use a microcontroller and infrared LED, to let Google Assistant control devices. Talk to your CD player using Google Home.","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066","og_locale":"en_US","og_type":"article","og_title":"Talk to your old CD Player - Sander Vonk","og_description":"Describes how to use a microcontroller and infrared LED, to let Google Assistant control devices. Talk to your CD player using Google Home.","og_url":"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066","og_site_name":"Coert Vonk","article_published_time":"2018-01-21T22:06:03+00:00","article_modified_time":"2022-05-01T00:56:23+00:00","twitter_card":"summary","twitter_image":"https:\/\/coertvonk.com\/wp-content\/uploads\/IR-device-icon-5.svg","twitter_misc":{"Written by":"Sander","Est. reading time":"10 minutes"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":["Person","Organization"],"@id":"https:\/\/coertvonk.com\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e","name":"Coert Vonk","image":{"@type":"ImageObject","@id":"https:\/\/coertvonk.com\/#personlogo","inLanguage":"en-US","url":"http:\/\/1.gravatar.com\/avatar\/193315b96c6661985694e2ecd91f2996?s=96&d=mm&r=g","contentUrl":"http:\/\/1.gravatar.com\/avatar\/193315b96c6661985694e2ecd91f2996?s=96&d=mm&r=g","caption":"Coert Vonk"},"logo":{"@id":"https:\/\/coertvonk.com\/#personlogo"},"description":"Passionately curious and stubbornly persistent. Enjoys to inspire and consult with others to exchange the poetry of logical ideas.","sameAs":["https:\/\/coertvonk.com"]},{"@type":"WebSite","@id":"https:\/\/coertvonk.com\/#website","url":"https:\/\/coertvonk.com\/","name":"Coert Vonk","description":"Embedded Software Engineer","publisher":{"@id":"https:\/\/coertvonk.com\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/coertvonk.com\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#primaryimage","inLanguage":"en-US","url":"https:\/\/coertvonk.com\/wp-content\/uploads\/IR-device-icon-5.svg","contentUrl":"https:\/\/coertvonk.com\/wp-content\/uploads\/IR-device-icon-5.svg"},{"@type":"WebPage","@id":"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#webpage","url":"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066","name":"Talk to your old CD Player - Sander Vonk","isPartOf":{"@id":"https:\/\/coertvonk.com\/#website"},"primaryImageOfPage":{"@id":"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#primaryimage"},"datePublished":"2018-01-21T22:06:03+00:00","dateModified":"2022-05-01T00:56:23+00:00","description":"Describes how to use a microcontroller and infrared LED, to let Google Assistant control devices. Talk to your CD player using Google Home.","breadcrumb":{"@id":"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066"]}]},{"@type":"BreadcrumbList","@id":"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Vonk Family","item":"https:\/\/coertvonk.com\/"},{"@type":"ListItem","position":2,"name":"Software","item":"https:\/\/coertvonk.com\/category\/sw"},{"@type":"ListItem","position":3,"name":"Arduino","item":"https:\/\/coertvonk.com\/category\/sw\/arduino"},{"@type":"ListItem","position":4,"name":"Talk to your old CD player"}]},{"@type":"Article","@id":"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#article","isPartOf":{"@id":"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#webpage"},"author":{"@id":"https:\/\/coertvonk.com\/#\/schema\/person\/521ea61187d3b92aa6edc27efb066099"},"headline":"Talk to your old CD player","datePublished":"2018-01-21T22:06:03+00:00","dateModified":"2022-05-01T00:56:23+00:00","mainEntityOfPage":{"@id":"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#webpage"},"wordCount":2010,"commentCount":0,"publisher":{"@id":"https:\/\/coertvonk.com\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e"},"image":{"@id":"https:\/\/coertvonk.com\/sw\/arduino\/talk-to-your-cd-player-23066#primaryimage"},"thumbnailUrl":"https:\/\/coertvonk.com\/wp-content\/uploads\/IR-device-icon-5.svg","articleSection":["Arduino"],"inLanguage":"en-US"},{"@type":"Person","@id":"https:\/\/coertvonk.com\/#\/schema\/person\/521ea61187d3b92aa6edc27efb066099","name":"Sander","image":{"@type":"ImageObject","@id":"https:\/\/coertvonk.com\/#personlogo","inLanguage":"en-US","url":"http:\/\/2.gravatar.com\/avatar\/50d5e0c60134564102be740dadcda2ce?s=96&d=mm&r=g","contentUrl":"http:\/\/2.gravatar.com\/avatar\/50d5e0c60134564102be740dadcda2ce?s=96&d=mm&r=g","caption":"Sander"},"description":"Student at MVHS.","url":"http:\/\/coertvonk.com\/author\/sander-vonk"}]}},"_links":{"self":[{"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/posts\/23066"}],"collection":[{"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/users\/4"}],"replies":[{"embeddable":true,"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/comments?post=23066"}],"version-history":[{"count":10,"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/posts\/23066\/revisions"}],"predecessor-version":[{"id":32852,"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/posts\/23066\/revisions\/32852"}],"wp:featuredmedia":[{"embeddable":true,"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/media\/23712"}],"wp:attachment":[{"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/media?parent=23066"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/categories?post=23066"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/tags?post=23066"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}