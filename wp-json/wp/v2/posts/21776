{"id":21776,"date":"2017-11-23T10:25:54","date_gmt":"2017-11-23T18:25:54","guid":{"rendered":"https:\/\/coertvonk.com\/?p=21776"},"modified":"2022-02-11T10:34:55","modified_gmt":"2022-02-11T18:34:55","slug":"discrete-low-pass-filter","status":"publish","type":"post","link":"http:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776","title":{"rendered":"Discrete FIR low-pass filter (unfinished)"},"content":{"rendered":"<p>\r\n    \\(\\)Similar to the <a href=\"\/category\/physics\/rlc-filters\/rc-low-pass-filter\">Analog RLC Filters<\/a>, discrete filters can remove low and\/or\r\n    high frequencies to suppress unwanted frequencies such as background noise. This article shows the math behind\r\n    these filters and visualizes their system response.\r\n<\/p>\r\n<p>\r\n    General .. FIR filters\r\n\r\n    <div class=\"flex-container tight\">\r\n        <a href=\"\/wp-content\/uploads\/img596.png\">\r\n            <img  title=\"\" loading=\"lazy\" src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/img596.png\" alt=\"\"\r\n            width=\"590\" height=\"116\" class=\"alignnone size-full wp-image-21860\" srcset=\"https:\/\/coertvonk.com\/wp-content\/uploads\/img596.png 590w, https:\/\/coertvonk.com\/wp-content\/uploads\/img596-400x79.png 400w\" sizes=\"(max-width: 590px) 100vw, 590px\" \/>\r\n        <\/a>\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    See <a href=\"https:\/\/ccrma.stanford.edu\/~jos\/filters\/FIR_impulse_response.html\">ccrma.stanford.edu<\/a> for more.\r\n<\/p>\r\n<p>\r\n    For a start we will start with an abbreviated description of the filter discussed in [Smith, J.O. Introduction to Digital Filters with Audio Applications, http:\/\/ccrma.stanford.edu\/~jos\/filters\/, online book, 2007 edition, accessed 2017-11-24].\r\n<\/p>\r\n<p>\r\n    The simplest low-pass filter is given by the difference equation\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            y[n]=x[n]+x[n-1]\r\n            \\label{eq:difeq}\r\n        $$\r\n    <\/div>\r\n    where \\(x[n]\\) is the input and \\(y[n]\\) is the output at sample \\(n\\).\r\n<\/p>\r\n<p>\r\n    The signal flow graph for this filter is\r\n\r\n    <div class=\"flex-container tight\">\r\n        <figure>\r\n            <div class=\"align-center fancybox\">\r\n                <a href=\"\/wp-content\/uploads\/FIR-Signal-Flow-1.svg\">\r\n                    <img src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/FIR-Signal-Flow-1.svg\" alt=\"FIR Filter Signal Flow\" class=\"alignnone size-full wp-image-21823\" width=\"300\" \/>\r\n                <\/a>\r\n        <\/div>\r\n        <figcaption>\r\n            Signal flow for simple FIR Low Pass Filter<br \/>\r\n            (\\(z^{-1}\\) means a delay of one sample)\r\n        <\/figcaption>\r\n    <\/figure>\r\n<\/div>\r\n<\/p>\r\n\r\n<h2>\r\n    Euler to the rescue\r\n<\/h2>\r\n\r\n<p>\r\n    We could study the system response to a general sinusoid input \\(x[n]=A\\cos(\\omega nT+\\phi)\\). To derive the gain and phase of this simple filter, we need over a page of equations using various trig identities.\r\n<\/p>\r\n<p>\r\n    We can avoid the trig identities by using <a href=\"https:\/\/coertvonk.com\/math\/pre-calc\/euler-identity-14997#formula\">Euler&#8217;s formula<\/a> and its <a href=\"https:\/\/coertvonk.com\/math\/pre-calc\/euler-identity-14997#trigonometry\">trigonometry connection<\/a>\r\n    <blockquote>\r\n        $$\r\n            \\begin{align}\r\n                \\mathrm{e}^{j\\varphi}&#038;=\\cos\\varphi+j\\sin\\varphi\\nonumber\\\\\r\n                \\cos\\varphi&#038;=\\frac{\\mathrm{e}^{j\\varphi}+\\mathrm{e}^{-j\\varphi}}{2}\\nonumber\r\n            \\end{align}\r\n            \\nonumber\r\n        $$\r\n    <\/blockquote>\r\n<\/p>\r\n<p>\r\n    Consider a complex sinusoid input \\(x[n]\\)\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            x[n]=A\\mathrm{e}^{j(\\omega nT+\\phi)}=A\\Big(\\cos(\\omega nT+\\phi)+j\\sin(\\omega nT+\\phi)\\Big)\r\n            \\label{eq:xn}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    We can simplify equation \\(\\eqref{eq:xn}\\):\r\n    <ul>\r\n        <li>\r\n            Because of linearity, input \\(\\mathrm{e}^{j\\omega nT}\\) is equivalent to putting \\(\\cos(\\omega nT)\\) and \\(j\\sin(\\omega nT)\\) in different copies of the filter and adding the outputs together. To study the filter, we may input the imaginary part, for as long as we ignore the associated imaginary output.\r\n        <\/li>\r\n        <li>\r\n            The filter gain doesn&#8217;t depend on the amplitude \\(A\\) due to linearity.\r\n        <\/li>\r\n        <li>\r\n            The filter phase response does not depend on \\(\\phi\\) due to time-invariance.\r\n        <\/li>\r\n    <ul>\r\n<\/p>\r\n<p>\r\n    With letting \\(A=1\\) and \\(\\phi=0\\), and promising to ignore the imaginary part of the output, equation \\(\\eqref{eq:xn}\\) can simplified to\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            x[n]=\\mathrm{e}^{j\\omega nT}\r\n            \\label{eq:xn2}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Substituting \\(\\eqref{eq:xn2}\\) in \\(\\eqref{eq:difeq}\\) gives the output in response to the complex sinusoid input\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{align}\r\n                y[n] &#038;= \\mathrm{e}^{j\\omega nT}+\\mathrm{e}^{j\\omega (n-1)T} \\nonumber \\\\\r\n                &#038;= \\mathrm{e}^{j\\omega nT}+\\mathrm{e}^{j\\omega nT}\\mathrm{e}^{-j\\omega T} \\nonumber \\\\\r\n                &#038;= \\underbrace{(1+\\mathrm{e}^{-j\\omega T})}_{H(\\omega)}\\ \\ \\underbrace{\\mathrm{e}^{j\\omega\r\n                nT}}_{x[n]}\r\n                \\label{eq:yn}\r\n            \\end{align}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n\r\n<h3>\r\n    Transfer function\r\n<\/h3>\r\n<p>\r\n    In equation \\(\\eqref{eq:yn}\\), the output \\(y[n]\\) is the input signal \\(x[n]\\) multiplied with what we will define as the filter&#8217;s transfer function \\(H(\\omega)\\).\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\shaded{\r\n                H(\\omega)\\triangleq 1+\\mathrm{e}^{-j\\omega T}\r\n            }\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Balance the exponents, so that we can apply <a href=\"https:\/\/coertvonk.com\/math\/pre-calc\/euler-identity-14997#trigonometry\">Euler&#8217;s trig connection<\/a> to \\(\\cos()\\)\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{align}\r\n                H\\left(\\mathrm{e}^{j\\omega T}\\right)\r\n                &#038;=1+\\mathrm{e}^{-j\\omega T}\\nonumber\\\\\r\n                &#038;=\\left( \\mathrm{e}^{j\\omega T\/2} + \\mathrm{e}^{-j\\omega T\/2} \\right)\\mathrm{e}^{-j\\omega\r\n                T\/2}\\nonumber\\\\\r\n                &#038;=2\\cos\\left(\\tfrac{\\omega T}{2}\\right)\\ \\mathrm{e}^{-j\\omega T\/2}\r\n            \\end{align}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Based on <a href=\"https:\/\/coertvonk.com\/math\/pre-calc\/euler-identity-14997#formula#coordinates\">Euler\u2019s formula<\/a>, we can express \\(H(\\omega)\\) in polar coordinates, where \\(G(\\omega)\\) is the gain (amplitude response), and \\(\\varphi(\\omega)\\) is the phase response\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            H(\\omega)=|H(\\omega)|\\,e^{j\\varphi(\\omega)}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n\r\n<h4>\r\n    Gain and Phase\r\n<\/h4>\r\n<p>\r\n    The gain \\(G(\\omega)\\) follows\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{align}\r\n                G(\\omega)\r\n                &#038;=\\left|2\\cos\\left(\\tfrac{\\omega T}{2}\\right)\\ \\mathrm{e}^{-j\\omega\r\n                T\/2}\\right|&#038;\\overset{|\\mathrm{e}^{-j\\alpha}|=1}{\\implies}\\nonumber\\\\\r\n                &#038;=2\\left|\\cos\\left(\\tfrac{\\omega\r\n                T}{2}\\right)\\right|&#038;\\overset{\\cos\\alpha=-\\cos\\alpha}{\\implies}\\nonumber\\\\\r\n                &#038;=2\\cos\\left(\\tfrac{\\omega T}{2}\\right)\r\n            \\end{align}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    The phase response \\(\\varphi(\\omega)\\) follows as\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{align}\r\n                \\varphi(\\omega)&#038;=\\angle\\Big(2\\cos\\left(\\tfrac{\\omega T}{2}\\right)\\ \\mathrm{e}^{-j\\omega\r\n                T\/2}\\Big)\\nonumber\\\\\r\n                &#038;=\\angle{2}+\\angle{\\cos\\left(\\tfrac{\\omega T}{2}\\right)}+\\angle\\mathrm{e}^{-j\\omega T\/2}\\\\\r\n                &#038;=0 + 0 -\\frac{\\omega T}{2}\\nonumber\\\\\r\n                &#038;=-\\frac{\\cancel{2}\\pi f}{\\cancel{2}}\\ \\frac{1}{f_s}\\nonumber\\\\\r\n                &#038;=-\\pi\\frac{f}{f_s},&#038;|f|\\leq\\frac{f_s}{2}\r\n            \\end{align}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Combining these we get the filter&#8217;s amplitude and phase response\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\left\\{\r\n                \\shaded{\r\n                \\begin{align}\r\n                    H(\\omega)&#038;=|H(\\omega)|\\ \\mathrm{e}^{-\\varphi(\\omega)}\\nonumber\\\\\r\n                    |H(\\omega)|&#038;=2\\cos\\left(\\tfrac{\\omega T}{2}\\right)\\nonumber\\\\\r\n                    \\varphi(\\omega)&#038;=-\\pi\\frac{f}{f_s},&#038;|f|\\leq\\frac{f_s}{2}\\nonumber\r\n                \\end{align}\r\n                }\r\n            \\right.\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    The gain goes sinusoidally from 2 to 0 as \\(\\omega T\\) goes from \\(0\\) to \\(\\pi\\). It is somewhat of a low-pass filter, but the slope of the filter is more gently as we usually would like to see in a low-pass filter. Then again, this filter was very simple and would be fast to implement.\r\n<\/p>\r\n<p>\r\n    The output signal y[n] follows from \\(\\eqref{eq:xn}\\)\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{align}\r\n                y[n]\r\n                &#038;=\\overbrace{|H(\\omega)|\\ \\mathrm{e}^{j\\varphi(\\omega)}}^{H(\\omega)}\\ \\overbrace{A\\mathrm{e}^{j(\\omega\r\n                nT+\\phi)}}^{x[n]}\\nonumber\\\\\r\n                &#038;=\\underbrace{|H(\\omega)|A}_\\text{amplitude}\\ \\mathrm{e}^{j(\\omega\r\n                nT+\\overbrace{\\phi+\\varphi(\\omega)}^\\text{phase})}\\nonumber\\\\\r\n            \\end{align}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Like any LTI filter, it can change the amplitude and phase of an incoming sinusoid signa.\r\n<\/p>\r\n<p>\r\n    Continue at <a href=\"https:\/\/ccrma.stanford.edu\/~jos\/filters\/Rederiving_Frequency_Response.html\">ccrma.stanford.edu<\/a>.\r\n<\/p>\r\n\r\n<h2>\r\n    IIR\r\n<\/h2>\r\n<p>\r\n    Here we describe a single-pole low-pass infinite impulse response (IIR) filter. In IIR filters the output depends on the past and current value of the input signal and past values of the output signal\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            H(z)=\\frac{b_0+b_1z^{-1}+b_2z^{-2}+\\ldots}{1 &#8211; a_1z^{-1}+a_2z^{-2}+\\ldots}=\\frac{\\sum_{k=0}^\\infty\r\n            b_k\\,z^{-k}}{1-\\sum_{k=1}^\\infty a_k\\,z^{-k}}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    See <a href=\"https:\/\/ccrma.stanford.edu\/~jos\/filters\/Definition_Simplest_Low_Pass.html\">ccrma.stanford.edu<\/a>.\r\n<\/p>\r\n<p>\r\n    The general form for IIR filters is\r\n<\/p>\r\n<p>\r\n    A single-pole low-pass infinite impulse response (IIR) filter is given by the Z-Transform\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            H(z)=\\frac{bz}{z-a}=\\frac{b}{1-az^{-1}}\r\n        $$\r\n    <\/div>\r\n    so \\(a+b=1\\) results in a unity gain\r\n<\/p>\r\n<p>\r\n    A low-pass single-pole IIR filter as a single design parameter, the decay value \\(d\\). It is customary to define parameters \\(a=d\\) and \\(b=1-d\\). For a typical value of \\(d=0.99\\), we get \\(a=0.99\\) and \\(b=0.01\\). The relation is given by\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            y[n]=b\\,x[n]+a\\,y[n-1]\r\n        $$\r\n    <\/div> \r\n\r\n    where the sequency \\(x[n]\\) is the input and \\(y[n]\\) is the output of the filter.\r\n<\/p>\r\n<p>\r\n    This relation directly shows the effect of the filter. The previous output value of the filter \\(y[n-1]\\) is decreased with the decay factor \\(a\\), and a small fraction \\(b\\) of the current input \\(x[n]\\) is taken into account.\r\n<\/p>\r\n<p>\r\n    Substituting \\(b=1-a\\) and rewriting gives the expression\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            y[n]=y[n-1]+b(\\,x[n]-y[n-1]\\,)\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    In the programming code, this is expressed as \\(y += b * (x &#8211; y)\\)\r\n<\/p>\r\n<p>\r\n    The response of this filter is completely analogous to the response of an analog low-pass filter containing a resistor and a capacitor.\r\n<\/p>\r\n<p>\r\n    Decay is related to the time constant \\(\\tau\\) of the filter.\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{align}\r\n                d&#038;=\\mathrm{e}^{-\\frac{1}{\\tau}}\\ \\ \\implies\r\n                \\tau=-\\frac{1}{\\ln d}\r\n            \\end{align}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    The cutoff frequency \\(f_c\\) is also related to \\(d\\) as\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{align}\r\n                d&#038;=\\mathrm{e}^{-2\\pi f_c}\\ \\ \\implies\r\n                f_c=-\\frac{\\ln d}{2\\pi}\r\n            \\end{align}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Further look at IIR filters:\r\n    <ol>\r\n        <li>\r\n            choose frequencies \\(\\omega_1\\ldots\\omega_L\\) at which the frequency response should contain a null, a dip or a peak.\r\n        <\/li>\r\n        <li>\r\n            Choose zeros \\(r_i=|z|\\mathrm{j\\omega_i}\\) at those frequencies \\(\\neq0\\) at which a null or dip should occur. With \\(|z|=1\\), or close to \\(1\\) as desired. For each such \\(\\omega_i\\), choose also a zero \\(r_j\\) that is the complex conjugate of \\(r_i\\). Let \\(M\\) be the total number of zeros chosen.\r\n        <\/li>\r\n        <li>\r\n            Choose poles \\(p_i=|z|\\mathrm{j\\omega_i}\\) at those frequencies \\(\\neq0\\) at which a null or dip should occur. With \\(|z|=1\\), or close to \\(1\\) as desired. For each such \\(\\omega_i\\), choose also a zero \\(r_j\\) that is the complex conjugate of \\(r_i\\). Let \\(N\\) be the total number of poles chosen.\r\n        <\/li>\r\n        <li>\r\n            Form the system function \\(H(z)=K\\frac{(1-r_1z^{-1})(1-r_2z^{-1})\\ldots(1-r_Mz^{-1})}{(1-p_1z^{-1})(1-p_2z^{-1})\\ldots(1-p_Nz^{-1})}\\), where \\(K\\) is the desired gain.\r\n        <\/li>\r\n        <li>\r\n            Cross multiply these factors of \\(H(z)\\), to express \\(H(z)\\) as the ratio of two polynomials whose terms are powers of \\(z^{-1}\\).\r\n        <\/li>\r\n        <li>\r\n            Identify the IIR filter coefficients {a_0,\\ldots,a_N,b_0,\\ldots,b_M}, which are simply the coefficients of the polynomials.\r\n        <\/li>\r\n        <li>\r\n            src: http:\/\/www.eecs.umich.edu\/courses\/eecs206\/archive\/spring02\/lab.dir\/Lab9\/lab9_v3_0_release.pdf\r\n        <\/li>\r\n    <\/ol>\r\n<\/p>\r\n<p>\r\n    Note <a href=\"https:\/\/tomroelandts.com\/articles\/low-pass-single-pole-iir-filter\">decay and cutoff frequency formulas<\/a>.\r\n<\/p>\r\n<p>\r\n    One of the simplest forms of passive filters consists of a resistor and capacitor in series The output is the voltage over the capacitor \\(y(t)\\) as shown in the schematic below.\r\n\r\n    <div class=\"flex-container tight\">\r\n        <figure>\r\n            <div class=\"align-center fancybox\">\r\n                <a class=\"hide-anchor\" href=\"\/wp-content\/uploads\/RC-filter-schematics.svg\">\r\n                    <img class=\" wp-image-15262 aligncenter\" src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/RC-filter-schematics.svg\" alt=\"own work\" width=\"300\" \/>\r\n                <\/a>\r\n            <\/div>\r\n        <\/figure>\r\n        <figcaption>\r\n            Schematic RC filter\r\n        <\/figcaption>\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    This type of filter is called an Infinite-Impulse Response (IIR) filter, because if you give it an impulse input, the output takes an infinite time to go down to <em>exactly<\/em> zero.\r\n<\/p>\r\n<p>\r\n    Even though this article shows a low pass filter, the same principles apply to a high pass filter where the output is taken over the resistor.\r\n<\/p>\r\n<p>\r\n    We will derive the transfer function for this filter and determine the step and frequency response functions. Required prior reading includes <a href=\"https:\/\/coertvonk.com\/category\/physics\/lfz-transforms\">Laplace Transforms<\/a>, <a href=\"https:\/\/coertvonk.com\/physics\/lfz-transforms\/foundations\/impedance-14252\">Impedance<\/a> and <a href=\"https:\/\/coertvonk.com\/physics\/lfz-transforms\/laplace\/transfer-functions-14257\">Transfer Functions<\/a>.\r\n<\/p>\r\n\r\n<h2>\r\n    Transfer Function\r\n<\/h2>\r\n<p>    \r\n    <div class=\"flex-container tight\">\r\n        <figure>\r\n            <div class=\"align-center fancybox\">\r\n                <a class=\"hide-anchor\" href=\"\/wp-content\/uploads\/TransferFunction.svg\">\r\n                    <img class=\"size-full wp-image-15344 aligncenter\" src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/TransferFunction.svg\" alt=\"TransferFunction\" width=\"300\" \/>\r\n                <\/a>\r\n        <\/div>\r\n        <figcaption>\r\n            Transfer function\r\n        <\/figcaption>\r\n    <\/figure>\r\n<\/div>\r\n<\/p>\r\n<p>\r\n    In the RC circuit, shown above, the current is the input voltage divided by the sum of the <a href=\"https:\/\/coertvonk.com\/physics\/lfz-transforms\/foundations\/impedance-14252#resistor\">impedance of the resistor<\/a> \\(Z_R=R\\) and that of the <a href=\"https:\/\/coertvonk.com\/physics\/lfz-transforms\/foundations\/impedance-14252#capacitor\">capacitor<\/a> \\(Z_C\\). The output is the voltage over the capacitor and equals the current through the system multiplied with the capacitor impedance. The transfer function follows as the quotient of the output and input signals.\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            H(s) = \\frac{Y(s)}{U(s)}=\\frac{Z_C}{Z_C+Z_R} = \\frac{1\/sC}{1\/sC+R} = \\frac{1}{sRC+1}\r\n            \\label{eq:voltagedivider}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    The denominator of \\(\\eqref{eq:voltagedivider}\\) is a first-order polynomial. The root of this polynomial is called the system\u2019s pole\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\shaded{\r\n                \\begin{array}{ccc}\r\n                    H(s) = K\\frac{1}{s-p},\r\n                    &#038;K = \\frac{1}{RC},\r\n                    &#038;p = -\\frac{1}{RC}\r\n                \\end{array}\r\n            }\r\n            \\label{eq:transferpolynomial}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    This first order system \\(\\eqref{eq:transferpolynomial}\\) has no zeros and one stable pole \\(p\\) on the left real axis \\(p<0\\) as visualized in the \\(s\\)-plane.\r\n\r\n    <div class=\"flex-container tight\">\r\n        <figure>\r\n            <div class=\"align-center fancybox\">\r\n                <a class=\"hide-anchor\" href=\"\/wp-content\/uploads\/z-plane-same-real-poles-1.svg\">\r\n                    <img class=\"aligncenter wp-image-14608\" src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/z-plane-same-real-poles-1.svg\" alt=\"own work\" width=\"300\" \/>\r\n                <\/a>\r\n        <\/div>\r\n        <figcaption>\r\n            \\(s\\)-plane\r\n        <\/figcaption>\r\n    <\/figure>\r\n<\/div>\r\n<\/p> \r\n\r\n<h2>\r\n    Unit Step Response\r\n<\/h2>\r\n<p>\r\n    The <a href=\"https:\/\/coertvonk.com\/physics\/lfz-transforms\/laplace\/evaluating-transfer-functions-15083#unitstep\">step response<\/a> gives an impression of the system behavior when the input signal going from \\(0\\) to \\(1\\) volt at time \\(t=0\\). This input is called the Unit Step Function, here represented by \\(u(t)=\\gamma(t)\\).\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{align}\r\n                \\gamma(t)&#038;=\\begin{cases}\r\n                0 &#038; t<0 \\\\\r\n                1 &#038; t\\geq0\r\n                \\end{cases}\\nonumber\\\\\r\n                \\implies\\ \\Gamma(s)&#038;=\\mathcal{L}\\left\\{\\gamma(t)\\right\\}=\\frac{1}{s}\r\n            \\end{align}\r\n            \\label{eq:unitstep}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Combining the <a href=\"https:\/\/coertvonk.com\/physics\/lfz-transforms\/laplace\/laplace-transforms-14929#unitstep\">Laplace transform of \\(\\gamma(t)\\), \\(\\Gamma(s)\\),<\/a> with the transfer function \\(\\eqref{eq:transferpolynomial}\\), gives the unit step response \\(Y(s)\\)\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{align}\r\n                Y(s)&#038;=\\Gamma(s)\\cdot H(s)\\nonumber \\\\\r\n                &#038;= \\frac{1}{s}\\cdot K\\frac{1}{(s-p)}\\nonumber \\\\\r\n                &#038;= K\\frac{1}{s(s-p)}\r\n            \\end{align}\r\n            \\label{eq:multiplication}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Split up this complicated fraction into forms that are in the Laplace Transform table. According to Heaviside, this can be expressed as partial fractions. [<a href=\"https:\/\/lpsa.swarthmore.edu\/BackGround\/PartialFraction\/PartialFraction.html\">swarthmore<\/a>, <a href=\"https:\/\/math.mit.edu\/~jorloff\/suppnotes\/suppnotes03\/h.pdf\">MIT-cu<\/a>]\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            Y(s)=K\\frac{1}{s(s+a)}\\equiv\\frac{c_0}{s}+\\frac{c_1}{s+a}\r\n            \\label{eq:heaviside}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Substitute \\(K=-p\\) from \\(\\eqref{eq:transferpolynomial}\\) and find expressions for the constants \\(c_{0,1}\\), by multiplying with respectively \\(s\\) and \\((s-p)\\)\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\left\\{\r\n                \\begin{eqnarray}\r\n                    -p\\frac{\\cancel{s}}{\\cancel{s}(s-p)} &#038;\\equiv&#038;\r\n                    \\frac{\\cancel{s}c_0}{\\cancel{s}}+\\frac{sc_1}{s-p}\\nonumber \\\\\r\n                    -p\\frac{\\cancel{s-p}}{s\\cancel{(s-p)}} &#038;\\equiv&#038;\r\n                    \\frac{c_0(s-p)}{s}+\\frac{c_1\\cancel{(s-p)}}{\\cancel{s-p}}\\nonumber\r\n                \\end{eqnarray}\r\n                \\right.\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Given that these equations are true for any value of \\(s\\), choose two convenient values of \\(s\\) that help us find \\(c_0\\) and \\(c_1\\).\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{eqnarray}\r\n                c_0 &#038;=&#038; \\left.\\frac{-p}{s-p}\\right|_{s=0}=1 \\label{eq:constants1a} \\\\\r\n                c_1 &#038;=&#038; \\left.\\frac{-p}{s}\\right|_{s=p}=-1 \\label{eq:constants1b}\r\n            \\end{eqnarray}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    The unit step response \\(y(t)\\) follows from the inverse Laplace transform of \\(\\eqref{eq:heaviside}\\)\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{align}\r\n                y(t)&#038;=\r\n                \\mathcal{L}^{-1}\\left\\{\\frac{c_0}{s}\\right\\}+\\mathcal{L}^{-1}\\left\\{\\frac{c_1}{s-p}\\right\\}, &#038;\r\n                t\\geq0\\nonumber \\\\\r\n                &#038;=c_0+c_1e^{pt}, &#038; t\\geq0\r\n            \\end{align}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Substituting the constants \\(\\eqref{eq:constants1a}, \\eqref{eq:constants1b}\\) gives the unit step response\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\shaded{\r\n                \\begin{array}{ccr}\r\n                    y(t)=1-e^{pt}, &#038; p=-\\frac{1}{RC}, &#038; t\\geq0\r\n                \\end{array}\r\n            }\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    As shown in the graph, the unit step response is a relatively slow decaying exponential curve (with \\(p\\lt 0\\)).\r\n\r\n    <div class=\"flex-container tight\">\r\n        <figure>\r\n            <div class=\"align-center fancybox\">\r\n                <a class=\"hide-anchor\" href=\"\/wp-content\/uploads\/RC-filter-unit-step-response-1.svg\">\r\n                    <img class=\"aligncenter size-full wp-image-15365\" src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/RC-filter-unit-step-response-1.svg\" alt=\"own work\" width=\"300\" \/>\r\n                <\/a>\r\n        <\/div>\r\n        <figcaption>\r\n            Unit step response\r\n        <\/figcaption>\r\n    <\/figure>\r\n<\/div>\r\n<\/p>\r\n<p>\r\n    The GNU Octave code used to print this figure is listed in the <a href=\"\/sw\/filters-sw\/discrete-low-pass-filter-21776#octavestep\">Appendix<\/a>.\r\n<\/p>\r\n\r\n<h2>\r\n    Frequency Response\r\n<\/h2>\r\n<p>\r\n    The <a href=\"https:\/\/coertvonk.com\/physics\/lfz-transforms\/laplace\/evaluating-transfer-functions-15083#frequency\">frequency response<\/a> \\(y_{ss}(t)\\) is defined as the steady state response to a sinusoidal input signal \\(u(t)=\\sin(\\omega t)\\,\\gamma(t)\\). It describes how well the filter can distinguish between different frequencies.\r\n<\/p>\r\n<p>\r\n    In <a href=\"https:\/\/coertvonk.com\/physics\/lfz-transforms\/laplace\/evaluating-transfer-functions-15083\">Evaluating Transfer Functions<\/a>, we have proven that\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            y_{ss}(t)=|H(j\\omega)|\\,\\sin(\\omega t+\\angle H(j\\omega))\\,\\gamma(t)\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    The transfer function \\(H(s)\\) for this RC Filter is given by \\(\\eqref{eq:transferpolynomial}\\)\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            H(s)=K\\frac{1}{s-p},\\\r\n            K = \\frac{1}{RC},\\\r\n            p = -\\frac{1}{RC}\r\n            \\label{eq:splane}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    The system behavior at \\(\\omega=0\\) and at \\(\\omega\\implies \\infty\\) indicates that this is a low pass filter.\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{align}\r\n                \\lim_{s \\implies j0} |H(s)| &#038;=-p\\frac{1}{0-p} =1 \\\\\r\n                \\lim_{s \\implies j\\infty} |H(s)| &#038;=-p\\frac{1}{\\infty-p} =0\r\n            \\end{align}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Based on <a href=\"https:\/\/coertvonk.com\/math\/pre-calc\/euler-identity-14997#coordinates\">Euler&#8217;s formula<\/a>, we can express \\(H(s)\\) in polar coordinates\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\left\\{\r\n                \\begin{align}\r\n                    H(s) &#038;= |H(s)|\\ e^{j\\angle{H(s)}}\\nonumber \\\\\r\n                    |H(s)| &#038;= K \\frac{\\prod_{i=1}^m\\left|(s-z_i)\\right|}{\\prod_{i=1}^n\\left|(s-p_i)\\right|}\r\n                    =K \\frac{1}{\\left|s-p\\right|}\\nonumber \\\\\r\n                    \\angle{H(s)}&#038;=\\sum_{i=1}^m\\angle(s-z_i)-\\sum_{i=1}^n\\angle(s-p_i)\r\n                    =-\\angle(s-p)\\nonumber\r\n                \\end{align}\r\n            \\right.\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    This transfer function with pole \\(p\\), evaluated for \\(s=j\\omega\\) can be visualized with a vector from the pole to \\(j\\omega\\).\r\n\r\n    <div class=\"flex-container tight\">\r\n        <figure>\r\n            <div class=\"align-center fancybox\">\r\n                <a class=\"hide-anchor\" href=\"\/wp-content\/uploads\/z-plane-same-real-poles-jw-1.svg\">\r\n                    <img class=\"aligncenter size-full wp-image-14609\" src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/z-plane-same-real-poles-jw-1.svg\" alt=\"own work\" width=\"300\" \/>\r\n                <\/a>\r\n        <\/div>\r\n        <figcaption>\r\n            Evaluated for \\(s=j\\omega\\)\r\n        <\/figcaption>\r\n    <\/figure>\r\n<\/div>\r\n<\/p>\r\n<p>\r\n    The length of the vector corresponds to \\(|(H(j\\omega)|\\), and minus the angle with the real axis corresponds to phase shift \\(\\angle H(j\\omega)\\).\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\left\\{\r\n                \\begin{align}\r\n                    |H(j\\omega)| &#038;=K \\frac{1}{\\left|j\\omega-p\\right|}=\r\n                    K \\frac{1}{\\sqrt{\\omega^2+p^2}}\\nonumber \\\\\r\n                    \\angle{H(j\\omega)}&#038;=-\\angle(j\\omega-p)=\\mathrm{atan2}(\\omega,-p)\\nonumber\\\\\r\n                    &#038;=-\\arctan\\frac{\\omega}{-p},\\ p\\lt 0\\land p\\in\\mathbb{R}\\nonumber\r\n                \\end{align}\r\n            \\right.\r\n            \\label{eq:polar1}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Substitute \\(p=-\\frac{1}{RC}\\) and \\(K=\\frac{1}{RC}\\)\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\left\\{\r\n                \\begin{eqnarray}\r\n                    |H(j\\omega)| &#038;=&#038;\\frac{1}{RC} \\frac{1}{\\sqrt{\\omega^2+\\left(\\frac{1}{RC}\\right)^2}}\\nonumber\r\n                    \\\\\r\n                    \\angle{H(j\\omega)}&#038;=&#038;-\\arctan\\frac{\\omega}{\\frac{1}{RC}}\\nonumber\r\n                \\end{eqnarray}\r\n            \\right.\r\n            \\label{eq:eq101}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    The output signal \\(y_{ss}(t)\\) for a sinusoidal input signal \\(\\sin(\\omega t)\\,\\gamma(t)\\)\r\n\r\n        $$\r\n            \\shaded{\r\n                \\begin{aligned}\r\n                    y_{ss}(t)&#038;=|H(j\\omega)|\\,\\sin(\\omega t+\\angle H(j\\omega))\\,\\gamma(t)\\nonumber \\\\\r\n                    |H(j\\omega)| &#038;=\\frac{1}{\\sqrt{(1+\\omega RC)^2}}\\\\\r\n                    \\angle{H(j\\omega)}&#038;=-\\arctan(\\omega RC)\\nonumber\r\n                \\end{aligned}\r\n            }\r\n            \\label{eq:frequencyresponse}\r\n        $$\r\n<\/p>\r\n<p>\r\n    This frequency response for different frequencies can be visualized in a Bode plot or a Nyquist diagram. Each of these are a topic of the remaining sections.\r\n<\/p>\r\n\r\n<h3>\r\n    Effect on Input with Harmonics\r\n<\/h3>\r\n<p>\r\n    As a side step, we examine the effect of the filter on a square wave input signal. The <a href=\"https:\/\/lpsa.swarthmore.edu\/Fourier\/Series\/ExFS.html#CosSeriesDC=0.5\">Fourier series<\/a> of the square wave shows that it consists of a base frequency and odd harmonics.\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            x(t)=\\frac{4}{\\pi}\\sum_{n=1,3,\\dots }^\\infty \\frac{\\sin\\left(n\\omega t\\right)\r\n            }{n}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Substituting \\(C=470\\ \\mathrm{nF}\\), \\(R=100\\ \\Omega\\) and 20 kHz in \\(\\eqref{eq:frequencyresponse}\\), gives the output signal \\(y_{ss}(t)\\)\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\left\\{\r\n                \\begin{align}\r\n                    y_{ss}(t)&#038;=\\frac{4}{\\pi}\\sum_{n=1,3,\\dots }^\\infty |H(jn\\omega)|\r\n                    \\frac{\\sin\\left(n\\omega t+\\angle H(jn\\omega)\\right)\r\n                    }{n}\\nonumber\\\\\r\n                    |H(jn\\omega)| &#038;=\\frac{1}{\\sqrt{(1+n\\omega RC)^2}}\\nonumber\\\\\r\n                    \\angle{H(jn\\omega)}&#038;=-\\arctan(n\\omega RC)\\nonumber\\\\\r\n                    RC&#038;=47\\cdot 10^{-6}\\nonumber\\\\\r\n                    \\omega&#038;=2\\pi20\\cdot 10^{3}\\nonumber\r\n                \\end{align}\r\n            \\right.\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    UNFINISHED\r\n<\/p>\r\n<p>    \r\n    <div class=\"flex-container tight\">\r\n        <figure>\r\n            <div class=\"align-center fancybox\">\r\n                <a class=\"hide-anchor\" href=\"\/wp-content\/uploads\/RC-filter-frequency-square.svg\">\r\n                    <img class=\"aligncenter size-full wp-image-15412\" src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/RC-filter-frequency-square.svg\" alt=\"own work\" width=\"300\" \/>\r\n                <\/a>\r\n        <\/div>\r\n        <figcaption>\r\n            Input and output signals\r\n        <\/figcaption>\r\n    <\/figure>\r\n<\/div>\r\n<\/p>\r\n\r\n<h3>\r\n    Bode plot\r\n<\/h3>\r\n<p>\r\n    A Bode plots frequency as the horizontal axis and usually consists of two separate plots to that show the magnitude and phase of the frequency response \\(y_{tt}\\). Since the range of magnitudes may also be large, the amplitude scale is usually expressed in decibels \\(20\\log_{10}\\left|H(j\\omega)\\right|\\) . The frequency axis uses a logarithmic scale as well.\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{align}\r\n                |H(j\\omega)|\\ &#038;= \\frac{1}{\\sqrt{1+(\\omega RC)^2}} \\\\\r\n                |H_{dB}(j\\omega)|\\ &#038;= -20\\log\\sqrt{1+ (\\omega RC)^2} \\\\\r\n                \\angle{H(j\\omega)}\\ &#038;=-\\arctan\\left(\\omega RC\\right)\r\n            \\end{align}\r\n            \\label{eq:polar2}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    The magnitude of the frequency response has a relatively shallow drop-off.\r\n\r\n    <div class=\"flex-container tight\">\r\n        <figure>\r\n            <div class=\"align-center fancybox\">\r\n                <a class=\"hide-anchor\" href=\"\/wp-content\/uploads\/RC-filter-frequency-response-1.svg\">\r\n                    <img class=\"aligncenter size-full wp-image-15368\" src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/RC-filter-frequency-response-1.svg\" alt=\"own work\" width=\"300\" \/>\r\n                <\/a>\r\n        <\/div>\r\n        <figcaption>\r\n            Frequency response\r\n        <\/figcaption>\r\n    <\/figure>\r\n<\/div>\r\n<\/p>\r\n<p>\r\n    The phase shift depends on the frequency, causing signals composed of multiple frequencies to be distorted.\r\n<\/p>\r\n<p>\r\n    Angular frequency \\(\\omega_c=|p|\\), is is known as the <em>cutoff, break, -3dB<\/em> or <em>half-power<\/em> frequency because the magnitude of the transfer function \\(\\eqref{eq:polar2}\\) equals \\(1\/\\sqrt{2}\\)\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{align}\r\n                |H(j\\omega_c)|\\ &#038;=\\dfrac{1}{\\sqrt{1+(\\omega_c RC)^2}}=\\frac{1}{\\sqrt{2}},\\\r\n                \\omega_c=\\left|p\\right|=\\frac{1}{RC} \\\\\r\n                |H_{dB}(j\\omega_c)|\\ &#038;= 20\\log\\frac{1}{\\sqrt{2}} \\approx-3\\rm{\\ dB}\r\n            \\end{align}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    The attenuation slope is calculated by first expressing the magnitude relative to the cutoff angular frequency \\(\\omega_c\\)\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{array}{llr}\r\n                &#038;|H(j\\omega)| = \\frac{1}{\\sqrt{1+\\left(\\frac{\\omega}{\\omega_c}\\right)^2}}\\\\\r\n                \\implies&#038;|H(j\\omega)| =\\frac{\\omega}{\\omega_c} &#038; \\forall\\ {\\omega\\gg\\omega_c}\r\n            \\end{array}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    The rate of change of attenuation is usually expressed in dB\/decade, where an decade is a factor of 10 in frequency, <em>\\(\\omega_2=10\\omega_1\\)<\/em>\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{gather}\r\n                \\begin{aligned}\r\n                    |H_{dB}(j\\omega_2)|-|H_{dB}(\\omega_1)|\\\r\n                    &#038;= -20\\log\\left(\\frac{10\\omega_1}{\\omega_c}\\right)+20\\log\\left(\\frac{\\omega_1}{\\omega_c}\\right)\r\n                    \\\\\r\n                    &#038;=20\\log\\left(\\frac{\\omega_1}{\\omega_c}\\frac{\\omega_c}{10\\omega_1}\\right) \\\\\r\n                    &#038;=-20 \\mathrm{\\ dB\/decade}\r\n                \\end{aligned}\r\n            \\end{gather}\r\n        $$\r\n<\/p>\r\n<p>\r\n    This single-pole filter gives has a relatively shallow -20 dB\/decade drop-off.\r\n<\/p>\r\n<p>\r\n    In general, the cutoff frequency is equal to the radial distance of the poles or zeros from the origin of the \\(s\\)-plane. For information on sketching the Bode magnitude plot from the poles and zeros, refer to Understanding Poles and Zeros [<a href=\"http:\/\/web.mit.edu\/2.14\/www\/Handouts\/PoleZero.pdf\">MIT 3.1<\/a>].\r\n<\/p>\r\n\r\n<h3>\r\n    Nyquist plot\r\n<\/h3>\r\n<p>\r\n    The Nyquist plots display both amplitude and phase angle on a single plot, using the angular frequency as the parameter. It helps visualize if a system is stable or unstable.\r\n<\/p>\r\n<p>\r\n    Starting with the transfer function \\(\\eqref{eq:transferpolynomial}\\)\r\n    \r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{gather}\r\n                \\begin{array}{ccc}\r\n                    H(s) = K\\frac{1}{s-p},\r\n                    &#038;K = \\frac{1}{RC},\r\n                    &#038;p = -\\frac{1}{RC}\r\n                \\end{array}\r\n            \\end{gather}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Evaluate at \\(s=j\\omega\\) and split into real and imaginary parts\r\n\r\n    <div class=\"flex-container math\">\r\n        $$\r\n            \\begin{gather}\r\n                \\begin{aligned}\r\n                    H(j\\omega)\\ &#038;=K\\frac{1}{j\\omega-p}\\\\\r\n                    &#038;=K\\frac{1}{j\\omega-p}\\frac{j\\omega+p}{j\\omega+p}\\\\\r\n                    &#038;=K\\frac{j\\omega+p}{-\\omega^2-p^2} \\\\\r\n                    &#038;=K\\frac{-j\\omega-p}{\\omega^2+p^2}\r\n                \\end{aligned}\\\\\r\n                \\implies\r\n                \\left\\{\r\n                    \\begin{aligned}\r\n                        \\Re\\left\\{{H(j\\omega)}\\right\\}=&#038;K\\frac{-p}{p^2+\\omega^2}\\\\\r\n                        \\Im\\left\\{{H(j\\omega)}\\right\\}=&#038;K\\frac{-\\omega}{p^2+\\omega^2}\\\\\r\n                    \\end{aligned}\r\n                \\right.\r\n            \\end{gather}\r\n        $$\r\n    <\/div>\r\n<\/p>\r\n<p>\r\n    Plot the frequency transfer function for \\(-\\infty\\lt\\omega\\lt\\infty\\), indicating an increase of frequency using an arrow. A dashed line is used for negative frequencies. (The plot was generated using the GNU\/Octave as shown in the <a href=\"\/sw\/filters-sw\/discrete-low-pass-filter-21776#octavenyquist\">appendix<\/a>.)\r\n\r\n    <div class=\"flex-container tight\">\r\n        <figure>\r\n            <div class=\"align-center fancybox\">\r\n                <a class=\"hide-anchor\" href=\"\/wp-content\/uploads\/RC-filter-frequency-nyquist-1.svg\">\r\n                    <img class=\"aligncenter size-full wp-image-15383\" src=\"https:\/\/coertvonk.com\/wp-content\/uploads\/RC-filter-frequency-nyquist-1.svg\" alt=\"own work\" width=\"300\" \/>\r\n                <\/a>\r\n        <\/div>\r\n        <figcaption>\r\n            Nyquist diagram\r\n        <\/figcaption>\r\n    <\/figure>\r\n<\/div>\r\n<\/p>\r\n<p>\r\n    From the plot we see that for \\(\\omega=0\\) the gain is 1, and for \\(\\omega\\to\\infty\\) the gain becomes 0. The high frequency portion of the plot approaches the origin at an angle of -90 degrees. For more information on Nyquist refer to Determining Stability using the Nyquist Plot [<a href=\"https:\/\/lpsa.swarthmore.edu\/Nyquist\/NyquistStability.html\">swarthmore<\/a>].\r\n<\/p>\r\n\r\n<h2>\r\n    Appendix\r\n<\/h2>\r\n\r\n<h3 id=\"octavestep\">\r\n    Unit Step Response in GNU\/Octave\r\n<\/h3>\r\n<p>\r\n    <pre class=\"brush: matlabkey; title: ; notranslate\" title=\"\">clc; close all; clear all; format short eng\r\nR=100; # 100Ohm\r\nC=470e-9; # 470nF\r\nw=logspace(3,5,200);\r\nf=w\/(2*pi);\r\nt=linspace(0,2e-3,200);\r\np=-1\/(R*C);\r\nu=1-e.^(p*t);\r\nh=plot(t,u);\r\naxis([min(t) max(t) 0 2]); #1.75\r\nxlabel('time [s]'); ylabel('|h(t)|');\r\nt=['Step Response(t), C=' num2str(C*1e9) 'nF, R=' num2str(R) '\\Omega']\r\ntitle(t, &amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;quot;fontsize&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;quot;, 15);<\/pre>\r\n<\/p>\r\n\r\n<h3 id=\"octavefrequency\">\r\n    Frequency Response in GNU\/Octave\r\n<\/h3>\r\n    <pre class=\"brush: matlabkey; title: ; notranslate\" title=\"\">clc; close all; clear all; format short eng\r\nR=100; # 100Ohm\r\nC=470e-9; # 470nF\r\nf=logspace(1,6,200);\r\nw=2*pi*f;\r\np=-1\/(R*C);\r\nu=-20*log10(sqrt(1+(w*R*C).^2));\r\nh=semilogx(f,u); hold on;\r\nwn=-p;\r\nplot([wn\/(2*pi) wn\/(2*pi)], get(gca,'YLim'),'k--');\r\ntext(wn\/(2*pi),5,'|p|\/2\\pi');\r\nf1=-p\/(2*pi);\r\nfmax=max(f);\r\nasymp=-20*log10((fmax-f1)\/f1);\r\nplot([min(f) f1 fmax],[0 0 asymp ],'k--');\r\nhold off\r\npoles=[-p -p];\r\nfigure(1);\r\ngrid off;\r\naxis([min(f) max(f) -80 40]);\r\nxlabel('frequency [Hz]'); ylabel('20log| H(t)|');\r\nleg=[strread(num2str(R,1),'%s');'asymptote'];\r\nt=['Bode Magnitude in dB(f), C=' num2str(C*1e9) 'nF, R=' num2str(R) '\\Omega'];\r\ntitle(t, &amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;quot;fontsize&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;quot;, 15);\r\nhold off;<\/pre>\r\n\r\n<h3 id=\"octavenyquist\">\r\n    Nyquist Diagram in GNU\/Octave\r\n<\/h3>\r\n    <pre class=\"brush: matlabkey; title: ; notranslate\" title=\"\">clc; close all; clear all; format short eng\r\npkg load control\r\nR=100; # 100Ohm\r\nC=470e-9; # 470nF\r\np=-1\/(R*C);\r\nH = tf([-p], [ 1 -p ]);\r\n[mag, phi, w] = bode(H); \r\nnyquist(H); h=gcf;\r\naxis ([-0.2, 1.2, -.7, .7], &amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;quot;square&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;quot;);<\/pre>\r\n\r\n<h3 id=\"octavenyquist\">\r\n    Square Wave in GNU\/Octave\r\n<\/h3>\r\n    <pre class=\"brush: matlabkey; title: ; notranslate\" title=\"\">clf;\r\nt=linspace(0,2e-3,1e4); # t from 0 to 2 msec, with 10,000 steps\r\nf=2e3; # input frequency [Hz]\r\nR=100; # 100 Ohms\r\nC=470e-9; # 470 nF\r\nM=1e5; # number of harmonics\r\nut=0; # input signal (square wave)\r\nyt=0; # output signal\r\n\r\nw=2*pi*f; # omega\r\nfc=1\/(2*pi*R*C) # cutoff (-3dB) frequency\r\n\r\nfor n=1:2:M,\r\n    nwt = n*w*t;\r\n    nwRC = n*w*R*C;\r\n    ut = ut + 4\/pi * sin(nwt) \/ n;\r\n    argH = 1 \/ sqrt( 1 + nwRC^2 );\r\n    angH = -atan(nwRC);\r\n    yt = yt + 4\/pi * argH * sin(nwt + angH) \/ n;\r\nend\r\n\r\nplot(t*1e3,ut, 'b-',t*1e3,yt)\r\ntitle('Square Wave input to RC filter')\r\nxlabel('t [msec]')\r\nylabel('[Volt]')\r\ngrid on;\r\nlegend('u(t)','y(t)')\r\nsaveas(1,&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;quot;square.svg&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;quot;)<\/pre>\r\n","protected":false},"excerpt":{"rendered":"Shows the math of first order discrete FIR low-pass filter.  Visualizes the poles in the Z-domain and step and frequency response.","protected":false},"author":41,"featured_media":0,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"inline_featured_image":false,"_mi_skip_tracking":false},"categories":[405],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v18.6 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Discrete FIR low-pass filter (unfinished) - Coert Vonk<\/title>\n<meta name=\"description\" content=\"Shows the math of first order discrete FIR low-pass filter. Visualizes the poles in the Z-domain and step and frequency response.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Discrete FIR low-pass filter (unfinished) - Coert Vonk\" \/>\n<meta property=\"og:description\" content=\"Shows the math of first order discrete FIR low-pass filter. Visualizes the poles in the Z-domain and step and frequency response.\" \/>\n<meta property=\"og:url\" content=\"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776\" \/>\n<meta property=\"og:site_name\" content=\"Coert Vonk\" \/>\n<meta property=\"article:published_time\" content=\"2017-11-23T18:25:54+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2022-02-11T18:34:55+00:00\" \/>\n<meta property=\"og:image\" content=\"https:\/\/coertvonk.com\/wp-content\/uploads\/img596.png\" \/>\n<meta name=\"twitter:card\" content=\"summary\" \/>\n<meta name=\"twitter:label1\" content=\"Written by\" \/>\n\t<meta name=\"twitter:data1\" content=\"Coert Vonk\" \/>\n\t<meta name=\"twitter:label2\" content=\"Est. reading time\" \/>\n\t<meta name=\"twitter:data2\" content=\"19 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebSite\",\"@id\":\"https:\/\/coertvonk.com\/#website\",\"url\":\"https:\/\/coertvonk.com\/\",\"name\":\"Coert Vonk\",\"description\":\"Embedded Software Engineer\",\"publisher\":{\"@id\":\"https:\/\/coertvonk.com\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/coertvonk.com\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#primaryimage\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/coertvonk.com\/wp-content\/uploads\/img596.png\",\"contentUrl\":\"https:\/\/coertvonk.com\/wp-content\/uploads\/img596.png\",\"width\":590,\"height\":116},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#webpage\",\"url\":\"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776\",\"name\":\"Discrete FIR low-pass filter (unfinished) - Coert Vonk\",\"isPartOf\":{\"@id\":\"https:\/\/coertvonk.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#primaryimage\"},\"datePublished\":\"2017-11-23T18:25:54+00:00\",\"dateModified\":\"2022-02-11T18:34:55+00:00\",\"description\":\"Shows the math of first order discrete FIR low-pass filter. Visualizes the poles in the Z-domain and step and frequency response.\",\"breadcrumb\":{\"@id\":\"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Vonk Family\",\"item\":\"https:\/\/coertvonk.com\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Software\",\"item\":\"https:\/\/coertvonk.com\/category\/sw\"},{\"@type\":\"ListItem\",\"position\":3,\"name\":\"Discrete filters\",\"item\":\"https:\/\/coertvonk.com\/category\/sw\/filters-sw\"},{\"@type\":\"ListItem\",\"position\":4,\"name\":\"Discrete FIR low-pass filter (unfinished)\"}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#article\",\"isPartOf\":{\"@id\":\"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#webpage\"},\"author\":{\"@id\":\"https:\/\/coertvonk.com\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e\"},\"headline\":\"Discrete FIR low-pass filter (unfinished)\",\"datePublished\":\"2017-11-23T18:25:54+00:00\",\"dateModified\":\"2022-02-11T18:34:55+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#webpage\"},\"wordCount\":3805,\"commentCount\":0,\"publisher\":{\"@id\":\"https:\/\/coertvonk.com\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e\"},\"image\":{\"@id\":\"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#primaryimage\"},\"thumbnailUrl\":\"https:\/\/coertvonk.com\/wp-content\/uploads\/img596.png\",\"articleSection\":[\"Discrete filters\"],\"inLanguage\":\"en-US\"},{\"@type\":[\"Person\",\"Organization\"],\"@id\":\"https:\/\/coertvonk.com\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e\",\"name\":\"Coert Vonk\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/coertvonk.com\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"http:\/\/1.gravatar.com\/avatar\/193315b96c6661985694e2ecd91f2996?s=96&d=mm&r=g\",\"contentUrl\":\"http:\/\/1.gravatar.com\/avatar\/193315b96c6661985694e2ecd91f2996?s=96&d=mm&r=g\",\"caption\":\"Coert Vonk\"},\"logo\":{\"@id\":\"https:\/\/coertvonk.com\/#personlogo\"},\"description\":\"Passionately curious and stubbornly persistent. Enjoys to inspire and consult with others to exchange the poetry of logical ideas.\",\"sameAs\":[\"https:\/\/coertvonk.com\"],\"url\":\"http:\/\/coertvonk.com\/author\/cvonk\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"Discrete FIR low-pass filter (unfinished) - Coert Vonk","description":"Shows the math of first order discrete FIR low-pass filter. Visualizes the poles in the Z-domain and step and frequency response.","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776","og_locale":"en_US","og_type":"article","og_title":"Discrete FIR low-pass filter (unfinished) - Coert Vonk","og_description":"Shows the math of first order discrete FIR low-pass filter. Visualizes the poles in the Z-domain and step and frequency response.","og_url":"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776","og_site_name":"Coert Vonk","article_published_time":"2017-11-23T18:25:54+00:00","article_modified_time":"2022-02-11T18:34:55+00:00","og_image":[{"url":"https:\/\/coertvonk.com\/wp-content\/uploads\/img596.png"}],"twitter_card":"summary","twitter_misc":{"Written by":"Coert Vonk","Est. reading time":"19 minutes"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebSite","@id":"https:\/\/coertvonk.com\/#website","url":"https:\/\/coertvonk.com\/","name":"Coert Vonk","description":"Embedded Software Engineer","publisher":{"@id":"https:\/\/coertvonk.com\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/coertvonk.com\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#primaryimage","inLanguage":"en-US","url":"https:\/\/coertvonk.com\/wp-content\/uploads\/img596.png","contentUrl":"https:\/\/coertvonk.com\/wp-content\/uploads\/img596.png","width":590,"height":116},{"@type":"WebPage","@id":"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#webpage","url":"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776","name":"Discrete FIR low-pass filter (unfinished) - Coert Vonk","isPartOf":{"@id":"https:\/\/coertvonk.com\/#website"},"primaryImageOfPage":{"@id":"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#primaryimage"},"datePublished":"2017-11-23T18:25:54+00:00","dateModified":"2022-02-11T18:34:55+00:00","description":"Shows the math of first order discrete FIR low-pass filter. Visualizes the poles in the Z-domain and step and frequency response.","breadcrumb":{"@id":"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776"]}]},{"@type":"BreadcrumbList","@id":"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Vonk Family","item":"https:\/\/coertvonk.com\/"},{"@type":"ListItem","position":2,"name":"Software","item":"https:\/\/coertvonk.com\/category\/sw"},{"@type":"ListItem","position":3,"name":"Discrete filters","item":"https:\/\/coertvonk.com\/category\/sw\/filters-sw"},{"@type":"ListItem","position":4,"name":"Discrete FIR low-pass filter (unfinished)"}]},{"@type":"Article","@id":"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#article","isPartOf":{"@id":"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#webpage"},"author":{"@id":"https:\/\/coertvonk.com\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e"},"headline":"Discrete FIR low-pass filter (unfinished)","datePublished":"2017-11-23T18:25:54+00:00","dateModified":"2022-02-11T18:34:55+00:00","mainEntityOfPage":{"@id":"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#webpage"},"wordCount":3805,"commentCount":0,"publisher":{"@id":"https:\/\/coertvonk.com\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e"},"image":{"@id":"https:\/\/coertvonk.com\/sw\/filters-sw\/discrete-low-pass-filter-21776#primaryimage"},"thumbnailUrl":"https:\/\/coertvonk.com\/wp-content\/uploads\/img596.png","articleSection":["Discrete filters"],"inLanguage":"en-US"},{"@type":["Person","Organization"],"@id":"https:\/\/coertvonk.com\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e","name":"Coert Vonk","image":{"@type":"ImageObject","@id":"https:\/\/coertvonk.com\/#personlogo","inLanguage":"en-US","url":"http:\/\/1.gravatar.com\/avatar\/193315b96c6661985694e2ecd91f2996?s=96&d=mm&r=g","contentUrl":"http:\/\/1.gravatar.com\/avatar\/193315b96c6661985694e2ecd91f2996?s=96&d=mm&r=g","caption":"Coert Vonk"},"logo":{"@id":"https:\/\/coertvonk.com\/#personlogo"},"description":"Passionately curious and stubbornly persistent. Enjoys to inspire and consult with others to exchange the poetry of logical ideas.","sameAs":["https:\/\/coertvonk.com"],"url":"http:\/\/coertvonk.com\/author\/cvonk"}]}},"_links":{"self":[{"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/posts\/21776"}],"collection":[{"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/users\/41"}],"replies":[{"embeddable":true,"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/comments?post=21776"}],"version-history":[{"count":10,"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/posts\/21776\/revisions"}],"predecessor-version":[{"id":31484,"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/posts\/21776\/revisions\/31484"}],"wp:attachment":[{"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/media?parent=21776"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/categories?post=21776"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/coertvonk.com\/wp-json\/wp\/v2\/tags?post=21776"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}