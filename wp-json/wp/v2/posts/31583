{"id":31583,"date":"2015-10-19T22:48:28","date_gmt":"2015-10-20T05:48:28","guid":{"rendered":"https:\/\/coert.vonk.one\/?p=31583"},"modified":"2022-04-27T18:03:28","modified_gmt":"2022-04-28T01:03:28","slug":"verification","status":"publish","type":"post","link":"/\/sw\/arduino\/pitch-detector\/verification-31583","title":{"rendered":"Verification"},"content":{"rendered":"<p>\r\n    Describes the verification for pitch detection on Arduino.  We will examine how well the algorithms did. Part of the project <a href=\"\/category\/sw\/pitch-detector\">Arduino Pitch Detector<\/a>.\\(\\)\r\n<\/p>\r\n\r\n<p>\r\n    The testing methodology reflects the three <a href=\"https:\/\/coert.vonk.one\/category\/sw\/pitch-detector\">design criteria<\/a>.\r\n\r\n    <ol>\r\n        <li>To test the frequency and <strong>pitch<\/strong> detection, I used clarinet and monophonic piano samples from the <a href=\"https:\/\/theremin.music.uiowa.edu\/index.html\">University of Iowa Electronic Music Studios<\/a>. The measured frequencies were corrected for transposing instruments such as the clarinet and then written to the debug port, and then imported into a spreadsheet for further evaluation.<\/li>\r\n        <li>For note level <strong>segmentation<\/strong>, I used commercial solo clarinet recordings such as &#8220;Sean Osborn, A Set for Clarinet Allegro&#8221;. The algorithm was verified by reading the piano roll output on the device and by listening to the output of the MIDI synthesizer.<\/li>\r\n        <li>To measure the <strong>delay<\/strong> between the note being played and being recognized, I edited the code adding a timer. I measured the delay between audio input and MIDI output.<\/li>\r\n    <\/ol>\r\n<\/p>\r\n<p>\r\n    While testing different algorithms, I found it very helpful to always use the same test set. I added configuration options that allows the device to read input from the memory card, and write the frequency and pitch detected to the debug port.\r\n<\/p>\r\n\r\n<h2>\r\n    Input\r\n<\/h2>\r\n<p>\r\n    Instead of taking input from the microphone, the audio samples will be read from \u03bcSD card. This replaces the first two components of the <a href=\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/signal-path-31569\">signal path<\/a> with samples read from  <code>.wav<\/code> files. The module <code>sddir.cpp<\/code> expects top level directories &#8220;NOTES&#8221; and &#8220;SOLOS&#8221;. The next level of directories should have the name of the sample rate (e.g. 9615). From there it will recurse the subdirectories and open each <code>.wav<\/code> file found. The module <code>wave.cpp<\/code> parses the TLV fields in the <code>.wav<\/code> file, and stores the samples in an array.\r\n<\/p>\r\n<p>\r\n    The frequency detection and segmentation algorithms can be tested independently.\r\n<\/p>\r\n\r\n<h2>\r\n    Frequency and pitch detection\r\n<\/h2>\r\n<p>\r\n    I use instrument samples from the <a href=\"https:\/\/theremin.music.uiowa.edu\/index.html\">University of Iowa Electronic Music Studios<\/a> supplemented with my own.\r\n\r\n    <ul>\r\n        <li>For example, for a clarinet sampled at 9615 S\/s, store 8-bit mono PCM wave files in the directory &#8220;<em>NOTES\/9615\/CLARINET\/<\/em>&#8220;. The file name should be the official note name such as DB4.WAV for D\u266d4.<\/li>\r\n        <li>Edit <code>config.h<\/code>, so that it takes input from <em>FILE<\/em> and writes to the <em>SERIAL<\/em> port. The output can then be imported into a spreadsheet for further evaluation. These results are presented in the <a href=\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/conclusion-31585\">conclusion<\/a> of this article.<\/li>\r\n    <\/ul>\r\n<\/p>\r\n\r\n<h2>\r\n    Note level segmentation\r\n<\/h2>\r\n<p>\r\n    <ul>\r\n        <li>\r\n            The algorithm is considered correct, when it tracks the pitch correctly and the melody of the original file has not been modified. The following test sets have been identified:\r\n            <ol>\r\n                <li>\r\n                    Monophonic music segmentation dataset (CMMSD)  [<a href=\"https:\/\/www.researchgate.net\/publication\/260000033_CMMSD_A_Data_Set_for_Note-Level_Segmentation_of_Monophonic_Music\" class=\"broken_link\">Coler, 2014<\/a>]\r\n                    <ul>\r\n                        <li>A new data set with annotations for monophonic audio excerpts. Annotations for note (steady state, sustain), transition (transient, release), and rest (silence, noise, reverberation). The data set consists of 36 items, excerpts of commercial recordings of solo performances of classical music. It covers the instruments bass, bassoon, cello, flute, horn, oboe, trombone, trumpet, and violin, and spans several periods of time in history.<\/li>\r\n                    <\/ul>\r\n                <\/li>\r\n                <li>\r\n                    Various solo clarinet recordings\r\n                    <ul>\r\n                        <li>Ernesto Molinari, Charme (pour clarinette) (amazon.com)<\/li>\r\n                        <li>Sean Osborn, A Set for Clarinet Allegro (amazon.com)<\/li>\r\n                        <li>Sean Osborn, A Set for Clarinet Adagio (amazon.com)<\/li>\r\n                        <li>Traditions of Excellence, book 1, page 38, exercise 4 on DVD (amazon.com)<\/li>\r\n                    <\/ul>\r\n                <\/li>\r\n            <\/ol>\r\n        <\/li>\r\n        <li>\r\n            To transcribe the music using the Arduino, store the recordings as 8-bit mono PCM wave files to SD card in the directory &#8220;<em>SOLOS<\/em>&#8220;. Remember to obey the <em>8.3<\/em> file name convention.\r\n        <\/li>\r\n        <li>\r\n            Edit <code>config.h<\/code>, so that it takes input from <code>FILE<\/code> and writes to <code>PIANOROLL<\/code>. This will also output MIDI events. Verify by either comparing the generated MIDI piano roll to the original score, or listening to the synthesizing MIDI events and comparing it to the original performance.\r\n        <\/li>\r\n    <\/ul>\r\n<\/p>\r\n<p>\r\n    <div class=\"continue-container no-print\">\r\n        <div class=\"continue-content\">\r\n            <div class=\"continue-text\">\r\n                This article concludes with a short conclusion on the <a href=\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/conclusion-31585\">next page<\/a>\r\n        <\/div>\r\n    <\/div>    \r\n<\/p>\r\n","protected":false},"excerpt":{"rendered":"Describes the verification for pitch detection on Arduino.  We will examine how well the chosen algorithms did. ","protected":false},"author":41,"featured_media":18417,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"inline_featured_image":false,"_mi_skip_tracking":false},"categories":[433],"tags":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v18.6 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Verification - Coert Vonk<\/title>\n<meta name=\"description\" content=\"Describes the verification for pitch detection on Arduino. We will examine how well the chosen algorithms did.\" \/>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Verification - Coert Vonk\" \/>\n<meta property=\"og:description\" content=\"Describes the verification for pitch detection on Arduino. We will examine how well the chosen algorithms did.\" \/>\n<meta property=\"og:url\" content=\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583\" \/>\n<meta property=\"og:site_name\" content=\"Coert Vonk\" \/>\n<meta property=\"article:published_time\" content=\"2015-10-20T05:48:28+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2022-04-28T01:03:28+00:00\" \/>\n<meta property=\"og:image\" content=\"https:\/\/coert.vonk.one\/wp-content\/uploads\/johan-pitch-detector-logo4.png\" \/>\n\t<meta property=\"og:image:width\" content=\"300\" \/>\n\t<meta property=\"og:image:height\" content=\"300\" \/>\n\t<meta property=\"og:image:type\" content=\"image\/png\" \/>\n<meta name=\"twitter:card\" content=\"summary\" \/>\n<meta name=\"twitter:label1\" content=\"Written by\" \/>\n\t<meta name=\"twitter:data1\" content=\"Coert Vonk\" \/>\n\t<meta name=\"twitter:label2\" content=\"Est. reading time\" \/>\n\t<meta name=\"twitter:data2\" content=\"3 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebSite\",\"@id\":\"https:\/\/coert.vonk.one\/#website\",\"url\":\"https:\/\/coert.vonk.one\/\",\"name\":\"Coert Vonk\",\"description\":\"Embedded Software Engineer\",\"publisher\":{\"@id\":\"https:\/\/coert.vonk.one\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/coert.vonk.one\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#primaryimage\",\"inLanguage\":\"en-US\",\"url\":\"https:\/\/coert.vonk.one\/wp-content\/uploads\/johan-pitch-detector-logo4.png\",\"contentUrl\":\"https:\/\/coert.vonk.one\/wp-content\/uploads\/johan-pitch-detector-logo4.png\",\"width\":300,\"height\":300},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#webpage\",\"url\":\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583\",\"name\":\"Verification - Coert Vonk\",\"isPartOf\":{\"@id\":\"https:\/\/coert.vonk.one\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#primaryimage\"},\"datePublished\":\"2015-10-20T05:48:28+00:00\",\"dateModified\":\"2022-04-28T01:03:28+00:00\",\"description\":\"Describes the verification for pitch detection on Arduino. We will examine how well the chosen algorithms did.\",\"breadcrumb\":{\"@id\":\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#breadcrumb\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583\"]}]},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Vonk Family\",\"item\":\"https:\/\/coert.vonk.one\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Software\",\"item\":\"https:\/\/coert.vonk.one\/category\/sw\"},{\"@type\":\"ListItem\",\"position\":3,\"name\":\"Arduino\",\"item\":\"https:\/\/coert.vonk.one\/category\/sw\/arduino\"},{\"@type\":\"ListItem\",\"position\":4,\"name\":\"Pitch detection\",\"item\":\"https:\/\/coert.vonk.one\/category\/sw\/arduino\/pitch-detector\"},{\"@type\":\"ListItem\",\"position\":5,\"name\":\"Verification\"}]},{\"@type\":\"Article\",\"@id\":\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#article\",\"isPartOf\":{\"@id\":\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#webpage\"},\"author\":{\"@id\":\"https:\/\/coert.vonk.one\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e\"},\"headline\":\"Verification\",\"datePublished\":\"2015-10-20T05:48:28+00:00\",\"dateModified\":\"2022-04-28T01:03:28+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#webpage\"},\"wordCount\":605,\"commentCount\":0,\"publisher\":{\"@id\":\"https:\/\/coert.vonk.one\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e\"},\"image\":{\"@id\":\"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#primaryimage\"},\"thumbnailUrl\":\"https:\/\/coert.vonk.one\/wp-content\/uploads\/johan-pitch-detector-logo4.png\",\"articleSection\":[\"Pitch detection\"],\"inLanguage\":\"en-US\"},{\"@type\":[\"Person\",\"Organization\"],\"@id\":\"https:\/\/coert.vonk.one\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e\",\"name\":\"Coert Vonk\",\"image\":{\"@type\":\"ImageObject\",\"@id\":\"https:\/\/coert.vonk.one\/#personlogo\",\"inLanguage\":\"en-US\",\"url\":\"http:\/\/1.gravatar.com\/avatar\/193315b96c6661985694e2ecd91f2996?s=96&d=mm&r=g\",\"contentUrl\":\"http:\/\/1.gravatar.com\/avatar\/193315b96c6661985694e2ecd91f2996?s=96&d=mm&r=g\",\"caption\":\"Coert Vonk\"},\"logo\":{\"@id\":\"https:\/\/coert.vonk.one\/#personlogo\"},\"description\":\"Passionately curious and stubbornly persistent. Enjoys to inspire and consult with others to exchange the poetry of logical ideas.\",\"sameAs\":[\"https:\/\/coert.vonk.one\"],\"url\":\"/\/author\/cvonk\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"Verification - Coert Vonk","description":"Describes the verification for pitch detection on Arduino. We will examine how well the chosen algorithms did.","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583","og_locale":"en_US","og_type":"article","og_title":"Verification - Coert Vonk","og_description":"Describes the verification for pitch detection on Arduino. We will examine how well the chosen algorithms did.","og_url":"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583","og_site_name":"Coert Vonk","article_published_time":"2015-10-20T05:48:28+00:00","article_modified_time":"2022-04-28T01:03:28+00:00","og_image":[{"width":300,"height":300,"url":"https:\/\/coert.vonk.one\/wp-content\/uploads\/johan-pitch-detector-logo4.png","type":"image\/png"}],"twitter_card":"summary","twitter_misc":{"Written by":"Coert Vonk","Est. reading time":"3 minutes"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebSite","@id":"https:\/\/coert.vonk.one\/#website","url":"https:\/\/coert.vonk.one\/","name":"Coert Vonk","description":"Embedded Software Engineer","publisher":{"@id":"https:\/\/coert.vonk.one\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/coert.vonk.one\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#primaryimage","inLanguage":"en-US","url":"https:\/\/coert.vonk.one\/wp-content\/uploads\/johan-pitch-detector-logo4.png","contentUrl":"https:\/\/coert.vonk.one\/wp-content\/uploads\/johan-pitch-detector-logo4.png","width":300,"height":300},{"@type":"WebPage","@id":"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#webpage","url":"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583","name":"Verification - Coert Vonk","isPartOf":{"@id":"https:\/\/coert.vonk.one\/#website"},"primaryImageOfPage":{"@id":"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#primaryimage"},"datePublished":"2015-10-20T05:48:28+00:00","dateModified":"2022-04-28T01:03:28+00:00","description":"Describes the verification for pitch detection on Arduino. We will examine how well the chosen algorithms did.","breadcrumb":{"@id":"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583"]}]},{"@type":"BreadcrumbList","@id":"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Vonk Family","item":"https:\/\/coert.vonk.one\/"},{"@type":"ListItem","position":2,"name":"Software","item":"https:\/\/coert.vonk.one\/category\/sw"},{"@type":"ListItem","position":3,"name":"Arduino","item":"https:\/\/coert.vonk.one\/category\/sw\/arduino"},{"@type":"ListItem","position":4,"name":"Pitch detection","item":"https:\/\/coert.vonk.one\/category\/sw\/arduino\/pitch-detector"},{"@type":"ListItem","position":5,"name":"Verification"}]},{"@type":"Article","@id":"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#article","isPartOf":{"@id":"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#webpage"},"author":{"@id":"https:\/\/coert.vonk.one\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e"},"headline":"Verification","datePublished":"2015-10-20T05:48:28+00:00","dateModified":"2022-04-28T01:03:28+00:00","mainEntityOfPage":{"@id":"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#webpage"},"wordCount":605,"commentCount":0,"publisher":{"@id":"https:\/\/coert.vonk.one\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e"},"image":{"@id":"https:\/\/coert.vonk.one\/sw\/arduino\/pitch-detector\/verification-31583#primaryimage"},"thumbnailUrl":"https:\/\/coert.vonk.one\/wp-content\/uploads\/johan-pitch-detector-logo4.png","articleSection":["Pitch detection"],"inLanguage":"en-US"},{"@type":["Person","Organization"],"@id":"https:\/\/coert.vonk.one\/#\/schema\/person\/5eeda746b43b88312a0621fdc226c70e","name":"Coert Vonk","image":{"@type":"ImageObject","@id":"https:\/\/coert.vonk.one\/#personlogo","inLanguage":"en-US","url":"http:\/\/1.gravatar.com\/avatar\/193315b96c6661985694e2ecd91f2996?s=96&d=mm&r=g","contentUrl":"http:\/\/1.gravatar.com\/avatar\/193315b96c6661985694e2ecd91f2996?s=96&d=mm&r=g","caption":"Coert Vonk"},"logo":{"@id":"https:\/\/coert.vonk.one\/#personlogo"},"description":"Passionately curious and stubbornly persistent. Enjoys to inspire and consult with others to exchange the poetry of logical ideas.","sameAs":["https:\/\/coert.vonk.one"],"url":"/\/author\/cvonk"}]}},"_links":{"self":[{"href":"/\/wp-json\/wp\/v2\/posts\/31583"}],"collection":[{"href":"/\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"/\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"/\/wp-json\/wp\/v2\/users\/41"}],"replies":[{"embeddable":true,"href":"/\/wp-json\/wp\/v2\/comments?post=31583"}],"version-history":[{"count":9,"href":"/\/wp-json\/wp\/v2\/posts\/31583\/revisions"}],"predecessor-version":[{"id":32781,"href":"/\/wp-json\/wp\/v2\/posts\/31583\/revisions\/32781"}],"wp:featuredmedia":[{"embeddable":true,"href":"/\/wp-json\/wp\/v2\/media\/18417"}],"wp:attachment":[{"href":"/\/wp-json\/wp\/v2\/media?parent=31583"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"/\/wp-json\/wp\/v2\/categories?post=31583"},{"taxonomy":"post_tag","embeddable":true,"href":"/\/wp-json\/wp\/v2\/tags?post=31583"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}